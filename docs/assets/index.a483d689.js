var t=Object.defineProperty,e=Object.defineProperties,n=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,a=(e,n,o)=>n in e?t(e,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[n]=o,r=(t,e)=>{for(var n in e||(e={}))s.call(e,n)&&a(t,n,e[n]);if(o)for(var n of o(e))i.call(e,n)&&a(t,n,e[n]);return t},c=(t,o)=>e(t,n(o));import{V as d}from"./vue.1457ee3a.js";import{V as l,_ as h,a as u,b as g,c as f,d as p,e as b,f as _,g as m,h as w,i as v,j as y,k,l as $,m as x,n as E,o as O,p as D,q as C,r as S,s as T,t as j,u as I,v as L,w as N,x as R,y as P,z as M}from"./vuetify.50e96a45.js";let A;const W={},B=function(t,e){if(!e)return t();if(void 0===A){const t=document.createElement("link").relList;A=t&&t.supports&&t.supports("modulepreload")?"modulepreload":"preload"}return Promise.all(e.map((t=>{if(t in W)return;W[t]=!0;const e=t.endsWith(".css"),n=e?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${t}"]${n}`))return;const o=document.createElement("link");return o.rel=e?"stylesheet":A,e||(o.as="script",o.crossOrigin=""),o.href=t,document.head.appendChild(o),e?new Promise(((t,e)=>{o.addEventListener("load",t),o.addEventListener("error",e)})):void 0}))).then((()=>t()))};d.use(l);var F=new l({theme:{options:{variations:!1,customProperties:!0},themes:{light:{background:"#f7f5f5",surface:"#fffdfd",panel:"#f4f2f2",primary:"#ad1625",primary_light:"#e5504d",primary_dark:"#760000",error:"#ec7422",highlight:"#fff5ce"},dark:{background:"#0b0808",surface:"#201d1d",panel:"#262424",primary:"#ad1625",primary_light:"#e5504d",primary_dark:"#760000",error:"#ec7422",highlight:"#716741"}}}});function G(t,e,n,o,s,i,a,r){var c,d="function"==typeof t?t.options:t;if(e&&(d.render=e,d.staticRenderFns=n,d._compiled=!0),o&&(d.functional=!0),i&&(d._scopeId="data-v-"+i),a?(c=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),s&&s.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(a)},d._ssrRegister=c):s&&(c=r?function(){s.call(this,(d.functional?this.parent:this).$root.$options.shadowRoot)}:s),c)if(d.functional){d._injectStyles=c;var l=d.render;d.render=function(t,e){return c.call(e),l(t,e)}}else{var h=d.beforeCreate;d.beforeCreate=h?[].concat(h,c):[c]}return{exports:t,options:d}}const q={};var U=G({name:"DemoSettings",props:{connection:null,config:{type:Object,default:()=>({enabled:!1})}},methods:{injectTab(t){this.connection.inject(t)}}},(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n(h,{attrs:{cols:"12",md:"5"}},[n("h3",{staticClass:"mb-6"},[t._v("Demo")]),n("p",[t._v("Random-data demo tab "),n(u,{attrs:{"x-small":""},on:{click:function(e){return t.injectTab("t0000")}}},[t._v("Inject")])],1),n("p",[t._v("Websocket demo tab "),n(u,{attrs:{"x-small":""},on:{click:function(e){return t.injectTab("t0001")}}},[t._v("Inject")])],1)])}),[],!1,(function(t){for(let e in q)this[e]=q[e]}),null,null,null);U.options.__file="src/connections/demo-settings.vue";var V=U.exports;function J(t,e,n){void 0===t&&(t=0),void 0===e&&(e=100),void 0===n&&(n=.1);let o=(e-t)*Math.random()+t,s=0,i=0,a=0;return()=>{function r(){let t;if(s)t=a*i;else{let e;do{e=2*Math.random()-1,a=2*Math.random()-1,i=e*e+a*a}while(i>=1);i=Math.sqrt(-2*Math.log(i)/i),t=e*i}return s^=1,t}let c;do{c=r()}while(o+c<t||o+c>e);return o+=c,d=o,Math.round(d/n)/Math.round(1/n);var d}}function X(t){return JSON.parse(JSON.stringify(t))}class Q extends Error{constructor(t){return super(t),this.name="StoreError",this}}function H(t,e){let n=t;for(const o of e)if(""==o);else if(Array.isArray(n)){const t=parseInt(o,10);if(Number.isNaN(t))throw new Q(`Array index '${o}' in '${e}' is not an int`);if(t<0||t>=n.length)throw new Q(`Array index '${o}' in '${e}' > ${n.length}`);n=n[t]}else{if("object"!=typeof n)throw new Q(`Level '${o}' of '${e}'' is not traversable: ${typeof n[o]}`);o in n&&void 0!==n[o]||d.set(n,o,{}),n=n[o]}return n}const K={icon:"rocket-launch",title:"",grids:[]},z={kind:"FixedGrid",title:"",widgets:[]},Y={kind:"Stat",rows:1,cols:1,static:{title:"Stat"},dynamic:{}};let Z=new class{constructor(){return this.root=d.observable({sd:{},$config:{dash:{},tabs:{},grids:{},widgets:{},conn:{}}}),this.sd=this.root.sd,this.config=this.root.$config,this.queue=[],this.undo=d.observable({buf:[],at:null}),this}insertData(t,e){let n=t.split("/");if(n=n.filter((t=>t.length>0)),0==n.length)throw new Q("Cannot replace entire hierarchy");if("$config"===t)return Object.keys(e).forEach((t=>{d.set(this.config,t,e[t])})),void console.log("Replaced $config with:",e);"$config"!==n[0]&&n.unshift("sd");const o=n.pop(),s=H(this.root,n);let i;if(Array.isArray(s)){const n=parseInt(o,10);if(Number.isNaN(n))throw new Q(`Array index '${o}' is not a number`);if(n>=0&&n<s.length){if(void 0===e)throw new Q(`Cannot delete array element '${n}' in '${t}'`);i=s[n],d.set(s,n,e)}else{if(n!=s.length)throw new Q(`Array index '${n}' in '${t}' > ${s.length}`);if(void 0===e)throw new Q(`Array index '${n}' in '${t}' >= ${s.length}`);i=void 0,s.push(e)}}else{if("object"!=typeof s)throw new Q(`${t} is neither Array nor Object in server state`);i=s[o],void 0!==e?d.set(s,o,e):delete s[o]}return i}pushUndo(t,e){const n=Date.now(),o=this.undo;if(o.at&&o.buf.length>0&&n-o.at<6e4&&t==o.buf[o.buf.length-1].tagline)console.log("undo coalesce"),o.buf[o.buf.length-1].mutation=[...e,...o.buf[o.buf.length-1].mutation];else for(o.at=n,o.buf.push({tagline:t,mutation:e});o.buf.length>10;)o.buf.shift()}performUndo(){console.log("perform undo");const t=this.undo;if(0==t.buf.length)throw new Q("undo buffer is empty");const e=t.buf.pop();t.at=null,this.qMutation(null,e.mutation)}qMutation(t,e){console.log("queueing mutation",t);let n=[];for(const o of e)n.unshift([o[0],this.insertData("$config/"+o[0],o[1])]);t&&this.pushUndo(t,n)}genId(t,e){let n=null;for(;!n||n in t;)n="00000"+Math.floor(1e4*Math.random()),n=e+n.substring(n.length-5);return n}tabByID(t){const e=this.config.tabs[t];if(e&&e.id==t)return e;throw new Q(`tab ${t} does not exist`)}gridByID(t){const e=this.config.grids[t];if(e&&e.id==t)return e;throw new Q(`grid ${t} does not exist`)}widgetByID(t){const e=this.config.widgets[t];if(e&&e.id==t)return e;throw new Q(`widget ${t} does not exist`)}tabIDByIX(t){const e=this.config.dash.tabs;if(e&&t>=0&&t<e.length)return e[t];throw new Q(`tab #${t} does not exist`)}gridIDByIX(t,e){if("string"==typeof t&&(t=this.tabByID(t)),t&&e>=0&&e<t.grids.length)return t.grids[e];throw new Q(`grid #${e} does not exist in tab ${t.id}`)}widgetIDByIX(t,e){if("string"==typeof t&&(t=this.gridByID(t)),t&&e>=0&&e<t.widgets.length)return t.widgets[e];throw new Q(`widget #${e} does not exist in grid ${t.id}`)}initDash(){if(this.config.dash.title)throw new Q("cannot init a non-empty store");this.insertData("$config/widgets",{}),this.insertData("$config/grids",{g00001:{id:"g00001",kind:"fixed-grid",widgets:[]}}),this.insertData("$config/tabs",{t00001:{id:"t00001",icon:"view-dashboard",grids:["g00001"]}}),this.insertData("$config/dash",{title:"FlexDash",tabs:["t00001"]})}addTab(){const t=this.genId(this.config.tabs,"t"),e=this.genId(this.config.grids,"g"),n=this.config.dash.tabs.length;return this.qMutation("add a tab",[[`grids/${e}`,c(r({},X(z)),{id:e})],[`tabs/${t}`,c(r({},X(K)),{id:t,grids:[e]})],[`dash/tabs/${n}`,t]]),n}deleteTab(t){const e=this.tabIDByIX(t),n=this.tabByID(e).grids,o=n.map((t=>this.config.grids[t].widgets)).flat();this.qMutation("delete a tab",[["dash/tabs",this.config.dash.tabs.filter(((e,n)=>n!=t))],[`tabs/${e}`,void 0],...n.map((t=>[`grids/${t}`,void 0])),...o.map((t=>[`widgets/${t}`,void 0]))])}updateTab(t,e){this.tabByID(t),this.qMutation(`update tab ${Object.keys(e).join(",")}`,Object.entries(e).map((([e,n])=>[`tabs/${t}/${e}`,n])))}updateDash(t){this.qMutation(`update dash ${Object.keys(t).join(",")}`,Object.entries(t).map((([t,e])=>[`dash/${t}`,e])))}addGrid(t){const e=this.tabByID(t),n=this.genId(this.config.grids,"g"),o=e.grids.length;return this.qMutation("add a grid",[[`grids/${n}`,c(r({},X(z)),{id:n})],[`tabs/${t}/grids/${o}`,n]]),o}deleteGrid(t,e){const n=this.tabByID(t),o=this.gridIDByIX(n,e),s=this.gridByID(o);this.qMutation("delete a grid",[[`tabs/${t}/grids`,n.grids.filter(((t,n)=>n!=e))],[`grids/${o}`,void 0],...s.widgets.map((t=>[`widgets/${t}`,void 0]))])}updateGrid(t,e){this.gridByID(t),this.qMutation(`update grid ${Object.keys(e).join(",")}`,Object.entries(e).map((([e,n])=>[`grids/${t}/${e}`,n])))}addWidget(t,e){const n=this.gridByID(t),o=this.genId(this.config.widgets,"w"),s=n.widgets.length;return this.qMutation("add a widget",[[`widgets/${o}`,c(r({},X(Y)),{id:o,kind:e,static:{title:e},dynamic:{}})],[`grids/${t}/widgets/${s}`,o]]),s}deleteWidget(t,e){const n=this.gridByID(t),o=this.widgetIDByIX(n,e);this.qMutation("delete a widget",[[`grids/${t}/widgets`,n.widgets.filter(((t,n)=>n!=e))],[`widgets/${o}`,void 0]])}updateWidget(t,e){this.widgetByID(t),this.qMutation(`update widget ${Object.keys(e).join(",")}`,Object.entries(e).map((([e,n])=>[`widgets/${t}/${e}`,n])))}updateWidgetProp(t,e,n,o){this.widgetByID(t),this.qMutation(`update widget prop ${e}:${n}`,[[`widgets/${t}/${e}/${n}`,o]])}};const tt={t0000:{tabs:{t0000:{id:"t0000",icon:"dice-multiple",grids:["g0000"]}},grids:{g0000:{id:"g0000",kind:"FixedGrid",widgets:["w0001","w0000","w0003","w0002","w0009","w0006","w0007","w0008","w0010","w0011","w0012","w0013","w0014","w0020","w0021","w0022","w0023"]}},widgets:{w0001:{kind:"Markdown",id:"w0001",cols:3,rows:5,dynamic:{},static:{title:"",text:'\n# Welcome to FlexDash\n\nYou are seeing the FlexDash demo dashboard. It shows a variety of _widgets_ spread across\nmultiple _tabs_. Each tab can have multiple _grids_ that lay out the widgets and that can be\nrolled up and down.\n\n### Getting started\n\nThe demo dashboard does not connect to any server and instead displays randomly generated data.\nTo connect to a server switch to the next "websock" tab and read the instructions there.\n\nTo edit the dashboard\'s configuration, switch to edit mode using the settings icon at\nthe top-right.\nIn edit mode all the items on the page have a little pencil icon, click on that to\nbring up an editing card. The exception to the pencil icon are the grid, which have a\ntoolbar across the page.\n\nAll editing is instantaneous while the dashboard remains live. If you make\na mistake, use the undo button at the top right. Unless you hook up a server connection\nand configure the server to persist the config, all changes you make here are in browser\nmemory only and are lost when you refresh the page.\n'}},w0000:{kind:"Stat",id:"w0000",static:{title:"Bedroom",value:"cold",unit:"F"},dynamic:{value:"$demo/bedroom"},rows:1,cols:1},w0002:{kind:"Stat",id:"w0002",static:{title:"Bedroom",unit:"F"},dynamic:{value:"$demo/bedroom"},rows:1,cols:1},w0003:{kind:"Gauge",id:"w0003",static:{title:"Hilltop",value:50,arc:270,center:!0,unit:"F",needle_color:"red",min:30},dynamic:{value:"$demo/hilltop"},rows:2,cols:2},w0006:{kind:"Gauge",id:"w0006",static:{title:"Kitchen",color:"lightblue",arc:90,unit:"F",min:0},dynamic:{value:"$demo/kitchen"},rows:1,cols:1},w0007:{kind:"Toggle",id:"w0007",static:{title:"light",off_value:"0",on_value:"ON",color:"secondary",value:"ON"},dynamic:{_output:"light",value:"light"},rows:1,cols:1},w0008:{kind:"PushButton",id:"w0008",static:{title:"launch",color:"secondary",output_value:"ON",icon:"rocket-launch",tooltip:"Next stop: Mars!"},dynamic:{_output:"light"},rows:1,cols:1},w0009:{kind:"PushButton",id:"w0009",static:{title:"",icon:"watering-can"},dynamic:{},rows:1,cols:1},w0010:{kind:"Gauge",id:"w0010",static:{title:"Kitchen",arc:180,base_color:"lightgreen",color:"blue",unit:"F",radius:90,needle_color:"white"},dynamic:{value:"$demo/kitchen"},rows:1,cols:1},w0011:{kind:"Sparkchart",id:"w0011",static:{title:"Hilltop",color:"green",line_width:4,fill:!0},dynamic:{value:"$demo/hilltop"},rows:1,cols:1},w0012:{kind:"Sparkchart",id:"w0012",static:{title:"Hilltop",bars:!0},dynamic:{value:"$demo/hilltop"},rows:1,cols:1},w0013:{kind:"Sparkchart",id:"w0013",static:{title:"Kitchen"},dynamic:{value:"$demo/kitchen"},rows:1,cols:2},w0014:{kind:"TimePlot",id:"w0014",static:{title:"Temperatures",left_unit:"°F",left_decimals:0,labels:Array.from({length:10},((t,e)=>"Sensor "+(e+1)))},dynamic:{data:"$demo/plot"},rows:4,cols:4},w0020:{kind:"RandomValue",id:"w0020",output:"$demo/kitchen",static:{title:"Rnd Kitchen",min:50,max:90},dynamic:{},rows:1,cols:1},w0021:{kind:"RandomValue",id:"w0021",output:"$demo/hilltop",static:{title:"Rnd Hilltop",min:20,max:90,seconds:6},dynamic:{},rows:1,cols:1},w0022:{kind:"RandomValue",id:"w0022",output:"$demo/bedroom",static:{title:"Rnd Bedroom",min:50,max:90,seconds:4},dynamic:{},rows:1,cols:1},w0023:{kind:"RandomArray",id:"w0023",output:"$demo/plot",static:{title:"Rnd Plot",min:50,max:90,seconds:7,length:11},dynamic:{},rows:1,cols:1}}},t0001:{tabs:{t0001:{id:"t0001",title:"websock",icon:"resistor-nodes",grids:["g0001"]}},grids:{g0001:{id:"g0001",kind:"FixedGrid",widgets:["w0015","w0016","w0017","w0018"]}},widgets:{w0015:{kind:"Markdown",id:"w0015",cols:4,rows:5,dynamic:{},static:{title:"",text:'# Websocket server connection\n\nFlexDash can establish a simple websocket connection to a server. This connection allows:\n- sending data from the server to FlexDash for display\n- sending user input from FlexDash to the server\n- persisting the FlexDash configuration on the server\n\nThe communication protocol uses very simple topic + payload messages,\nsuch as `{"topic":"foo", "payload":199}`,\nwhere the topic establishes the binding between the data and a widget in FlexDash.\n\n### Connecting to Node-Red\n\nBefore connecting to Node-Red the latter needs two nodes to send websocket data:\n\n1- A `websocket-out` node to send data configured as follows:\n- the type set to "listen on"\n- the path set to "Add new websocket listener" and, using the pencil button, the listener\'s path set to `/ws/flexdash` and "send/receive" to "entire message".\n\n2- An inject node with the topic set to `ws_data` and the payload set to some short string like\n"hello" or some number\n- the inject node connected to the websocket-out node\n\nThis should look something like this: ![inject into websocket](/flexdash/img/howto-ws-2nodes.png)\n\nNow deploy those two nodes and open the connection editing panel here in FlexDash using the\nnetwork icon at the top-right. Set the websocket address to the Node-Red server\'s hostname,\nport, and a path of `/ws/flexdash` (this needs to match the path set in the websocket listener\nin Node-Red). The address should look something like `ws://localhost:1880/ws/flexdash`.\nThen enable the websocket and the status should shortly change to _connected_.\n\nOnce the connection is established, hit the inject node button and the value set in its payload\nwill show up in the stats widget to the right of this text widget. It is now possible to wire\nadditional nodes into the `websocket-out` to send values to other widgets. It is also possible\nto instantiate additional `websocket-out` nodes if that is more convenient.\n\nTo bind new data values to a new widget, ensure that the `msg.topic` of those values is unique,\nadd the desired widget to the grid (turn on _edit mode_ using the settings menu\nat the top-right), and set the widget\'s input (typically _value_) to be linked to the topic.\n\n### Sending user input to Node-Red\n\nSending user input from a toggle widget or a push button widget to Node-Red is simple as well:\n- Instantiate a `websocket-in` node and configure it to use the same "listen on" path as the `websocket-out`.\n- Add a `switch` node set to filter the desired topic, switch" in this example.\n- Hook up a debug node to see the messages or, alternatively, add a `change` node to set the topic to "light" and feed that into a `websocket-out`, this second option might look like this:\n\n![feed switch into light](/flexdash/img/howto-ws-inout.png)\n\nIf you use the "switch" and "light" topics the toggle node on this page should control the value\nof the stat node via Node-Red.\n\nThe websocket demo flows mentioned above are available\nfor [download](/flexdash/misc/ws-demo-flow.json).\n\n### Opening the websocket at load\n\nInstead of configuring the websocket connection each time the dashboard is loaded it is\npossible to encode the websocket address in the URL using a `ws` query string parameter,\nfor example:\n\nhttps://tve.github.io/flexdash/?ws=ws://localhost:1880/ws/flexdash\n\nIt is further possible to jump straight to a specific tab by adding the tab name or the\ntab\'s icon name as anchor, for example:\n\nhttps://tve.github.io/flexdash/?ws=ws://localhost:1880/ws/flexdash#websock\n\n### Saving the dashboard config over websocket\n\n... not yet implemented: stay tuned!\n'}},w0016:{kind:"Stat",id:"w0016",static:{title:"ws_data",unit:""},dynamic:{value:"ws_data"},rows:1,cols:1},w0017:{kind:"Toggle",id:"w0017",static:{title:"Light switch",on_value:"ON",off_value:"OFF"},dynamic:{value:"light"},output:"switch",rows:1,cols:1},w0018:{kind:"Stat",id:"w0018",static:{title:"Light",unit:""},dynamic:{value:"light"},rows:1,cols:1}}}};class et{constructor(t,e){return this.storeInsert=e,this.data=d.observable({status:"off"}),this}start(){this.data.status="ok",Object.keys(tt).sort().forEach((t=>this.inject(t)))}inject(t){if(t in tt){if(!Z.config.dash.tabs){const t=Z.config.conn||{};console.log("Demo injecting $config"),this.storeInsert({topic:"$config",payload:{dash:{title:"FlexDash",tabs:[]},tabs:{},grids:{},widgets:{},conn:t}})}for(let e in tt[t])for(let n in tt[t][e])console.log(`Demo injecting $config/${e}/${n}`),this.storeInsert({topic:`$config/${e}/${n}`,payload:tt[t][e][n]});if(!Z.config.dash.tabs.includes(t)){const e=Z.config.dash.tabs.length;console.log(`Demo injecting $config/dash/tabs/${e}`),this.storeInsert({topic:`$config/dash/tabs/${e}`,payload:t})}}}stop(){this.data.status="off"}}const nt={};var ot=G({name:"WebsockSettings",props:{connection:null,config:{type:Object,default:()=>({enabled:!1,address:""})}},created(){console.log("ws-settings created, config:",JSON.stringify(this.config),"connection:",JSON.stringify(this.connection))},computed:{last_msg(){if(!this.config.enabled)return"- disabled -";if(!this.connection||!this.connection.data.last_msg.topic)return"- none -";const t=JSON.stringify(this.connection.data.last_msg.payload);return`"${this.connection.data.last_msg.topic}" <- ${t}`},status_txt(){return console.log("status_txt, this.config:",this.config),this.config.enabled&&this.connection?this.connection.data.status_txt:"disabled"},status_color(){return this.config.enabled&&this.connection?"ok"==this.connection.data.status?"success":"bad"==this.connection.data.status?"error":"grey":"grey"},disable(){return!this.connection}},methods:{handleEnabled(t){this.config.enabled=t,t?(console.log("WS now enabled, addr:",this.config),this.connection.start(this.config.address)):(console.log("WS now disabled"),this.connection.stop())},handleAddress(t){this.config.address=t,this.config.enabled&&(console.log("WS: address changed, reconnecting"),this.connection.stop(),this.connection.start(this.config.address))},validateAddress:t=>t.match(/^(ws|http)s?:[/][/]/)?!!t.match(/^(ws|http)s?:[/][/][^/]+\//)||"address must contain hostname and path":"address must start with ws:// or wss://"}},(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n(h,{attrs:{cols:"12",md:"5"}},[n("div",{staticStyle:{width:"100%",display:"flex","justify-content":"space-between","align-items":"baseline"}},[n("h3",[t._v("Websocket")]),n(g,{attrs:{small:"",color:t.status_color}},[t._v(t._s(t.status_txt))])],1),n(f,{attrs:{label:"enabled",disabled:t.disable,"input-value":t.config.enabled,"hide-details":""},on:{change:t.handleEnabled}}),n(p,{attrs:{label:"websocket server address","persistent-hint":"",clearable:"",value:t.config.address,rules:[t.validateAddress],hint:"wss://server.example.com/mydash, ws://localhost:1880/ws/fd"},on:{change:t.handleAddress}}),n(p,{attrs:{disabled:"","persistent-hint":"",hint:"last message received",value:t.last_msg}})],1)}),[],!1,(function(t){for(let e in nt)this[e]=nt[e]}),null,null,null);ot.options.__file="src/connections/websock-settings.vue";var st=ot.exports,it=function(t,e){return(it=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function at(t,e){function n(){this.constructor=t}it(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function rt(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,s,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(r){s={error:r}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(s)throw s.error}}return a}function ct(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(rt(arguments[e]));return t}var dt=function(t,e){this.target=e,this.type=t},lt=function(t){function e(e,n){var o=t.call(this,"error",n)||this;return o.message=e.message,o.error=e,o}return at(e,t),e}(dt),ht=function(t){function e(e,n,o){void 0===e&&(e=1e3),void 0===n&&(n="");var s=t.call(this,"close",o)||this;return s.wasClean=!0,s.code=e,s.reason=n,s}return at(e,t),e}(dt),ut={maxReconnectionDelay:1e4,minReconnectionDelay:1e3+4e3*Math.random(),minUptime:5e3,reconnectionDelayGrowFactor:1.3,connectionTimeout:4e3,maxRetries:1/0,maxEnqueuedMessages:1/0,startClosed:!1,debug:!1},gt=function(){function t(t,e,n){var o=this;void 0===n&&(n={}),this._listeners={error:[],message:[],open:[],close:[]},this._retryCount=-1,this._shouldReconnect=!0,this._connectLock=!1,this._binaryType="blob",this._closeCalled=!1,this._messageQueue=[],this.onclose=null,this.onerror=null,this.onmessage=null,this.onopen=null,this._handleOpen=function(t){o._debug("open event");var e=o._options.minUptime,n=void 0===e?ut.minUptime:e;clearTimeout(o._connectTimeout),o._uptimeTimeout=setTimeout((function(){return o._acceptOpen()}),n),o._ws.binaryType=o._binaryType,o._messageQueue.forEach((function(t){return o._ws.send(t)})),o._messageQueue=[],o.onopen&&o.onopen(t),o._listeners.open.forEach((function(e){return o._callEventListener(t,e)}))},this._handleMessage=function(t){o._debug("message event"),o.onmessage&&o.onmessage(t),o._listeners.message.forEach((function(e){return o._callEventListener(t,e)}))},this._handleError=function(t){o._debug("error event",t.message),o._disconnect(void 0,"TIMEOUT"===t.message?"timeout":void 0),o.onerror&&o.onerror(t),o._debug("exec error listeners"),o._listeners.error.forEach((function(e){return o._callEventListener(t,e)})),o._connect()},this._handleClose=function(t){o._debug("close event"),o._clearTimeouts(),o._shouldReconnect&&o._connect(),o.onclose&&o.onclose(t),o._listeners.close.forEach((function(e){return o._callEventListener(t,e)}))},this._url=t,this._protocols=e,this._options=n,this._options.startClosed&&(this._shouldReconnect=!1),this._connect()}return Object.defineProperty(t,"CONNECTING",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(t,"OPEN",{get:function(){return 1},enumerable:!0,configurable:!0}),Object.defineProperty(t,"CLOSING",{get:function(){return 2},enumerable:!0,configurable:!0}),Object.defineProperty(t,"CLOSED",{get:function(){return 3},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"CONNECTING",{get:function(){return t.CONNECTING},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"OPEN",{get:function(){return t.OPEN},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"CLOSING",{get:function(){return t.CLOSING},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"CLOSED",{get:function(){return t.CLOSED},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"binaryType",{get:function(){return this._ws?this._ws.binaryType:this._binaryType},set:function(t){this._binaryType=t,this._ws&&(this._ws.binaryType=t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"retryCount",{get:function(){return Math.max(this._retryCount,0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bufferedAmount",{get:function(){return this._messageQueue.reduce((function(t,e){return"string"==typeof e?t+=e.length:e instanceof Blob?t+=e.size:t+=e.byteLength,t}),0)+(this._ws?this._ws.bufferedAmount:0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"extensions",{get:function(){return this._ws?this._ws.extensions:""},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"protocol",{get:function(){return this._ws?this._ws.protocol:""},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"readyState",{get:function(){return this._ws?this._ws.readyState:this._options.startClosed?t.CLOSED:t.CONNECTING},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"url",{get:function(){return this._ws?this._ws.url:""},enumerable:!0,configurable:!0}),t.prototype.close=function(t,e){void 0===t&&(t=1e3),this._closeCalled=!0,this._shouldReconnect=!1,this._clearTimeouts(),this._ws?this._ws.readyState!==this.CLOSED?this._ws.close(t,e):this._debug("close: already closed"):this._debug("close enqueued: no ws instance")},t.prototype.reconnect=function(t,e){this._shouldReconnect=!0,this._closeCalled=!1,this._retryCount=-1,this._ws&&this._ws.readyState!==this.CLOSED?(this._disconnect(t,e),this._connect()):this._connect()},t.prototype.send=function(t){if(this._ws&&this._ws.readyState===this.OPEN)this._debug("send",t),this._ws.send(t);else{var e=this._options.maxEnqueuedMessages,n=void 0===e?ut.maxEnqueuedMessages:e;this._messageQueue.length<n&&(this._debug("enqueue",t),this._messageQueue.push(t))}},t.prototype.addEventListener=function(t,e){this._listeners[t]&&this._listeners[t].push(e)},t.prototype.dispatchEvent=function(t){var e,n,o=this._listeners[t.type];if(o)try{for(var s=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}(o),i=s.next();!i.done;i=s.next()){var a=i.value;this._callEventListener(t,a)}}catch(r){e={error:r}}finally{try{i&&!i.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}return!0},t.prototype.removeEventListener=function(t,e){this._listeners[t]&&(this._listeners[t]=this._listeners[t].filter((function(t){return t!==e})))},t.prototype._debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._options.debug&&console.log.apply(console,ct(["RWS>"],t))},t.prototype._getNextDelay=function(){var t=this._options,e=t.reconnectionDelayGrowFactor,n=void 0===e?ut.reconnectionDelayGrowFactor:e,o=t.minReconnectionDelay,s=void 0===o?ut.minReconnectionDelay:o,i=t.maxReconnectionDelay,a=void 0===i?ut.maxReconnectionDelay:i,r=0;return this._retryCount>0&&(r=s*Math.pow(n,this._retryCount-1))>a&&(r=a),this._debug("next delay",r),r},t.prototype._wait=function(){var t=this;return new Promise((function(e){setTimeout(e,t._getNextDelay())}))},t.prototype._getNextUrl=function(t){if("string"==typeof t)return Promise.resolve(t);if("function"==typeof t){var e=t();if("string"==typeof e)return Promise.resolve(e);if(e.then)return e}throw Error("Invalid URL")},t.prototype._connect=function(){var t=this;if(!this._connectLock&&this._shouldReconnect){this._connectLock=!0;var e=this._options,n=e.maxRetries,o=void 0===n?ut.maxRetries:n,s=e.connectionTimeout,i=void 0===s?ut.connectionTimeout:s,a=e.WebSocket,r=void 0===a?function(){if("undefined"!=typeof WebSocket)return WebSocket}():a;if(this._retryCount>=o)this._debug("max retries reached",this._retryCount,">=",o);else{if(this._retryCount++,this._debug("connect",this._retryCount),this._removeListeners(),void 0===(c=r)||!c||2!==c.CLOSING)throw Error("No valid WebSocket class provided");var c;this._wait().then((function(){return t._getNextUrl(t._url)})).then((function(e){t._closeCalled||(t._debug("connect",{url:e,protocols:t._protocols}),t._ws=t._protocols?new r(e,t._protocols):new r(e),t._ws.binaryType=t._binaryType,t._connectLock=!1,t._addListeners(),t._connectTimeout=setTimeout((function(){return t._handleTimeout()}),i))}))}}},t.prototype._handleTimeout=function(){this._debug("timeout event"),this._handleError(new lt(Error("TIMEOUT"),this))},t.prototype._disconnect=function(t,e){if(void 0===t&&(t=1e3),this._clearTimeouts(),this._ws){this._removeListeners();try{this._ws.close(t,e),this._handleClose(new ht(t,e,this))}catch(n){}}},t.prototype._acceptOpen=function(){this._debug("accept open"),this._retryCount=0},t.prototype._callEventListener=function(t,e){"handleEvent"in e?e.handleEvent(t):e(t)},t.prototype._removeListeners=function(){this._ws&&(this._debug("removeListeners"),this._ws.removeEventListener("open",this._handleOpen),this._ws.removeEventListener("close",this._handleClose),this._ws.removeEventListener("message",this._handleMessage),this._ws.removeEventListener("error",this._handleError))},t.prototype._addListeners=function(){this._ws&&(this._debug("addListeners"),this._ws.addEventListener("open",this._handleOpen),this._ws.addEventListener("close",this._handleClose),this._ws.addEventListener("message",this._handleMessage),this._ws.addEventListener("error",this._handleError))},t.prototype._clearTimeouts=function(){clearTimeout(this._connectTimeout),clearTimeout(this._uptimeTimeout)},t}();class ft{constructor(t,e){return this.sendMsg=t,this.recvMsg=e,this.rws=null,this.data=d.observable({last_msg:{topic:null,payload:null},status:"off",status_txt:"off"}),this}start(t){console.log("WS: connecting to",t),this.data.status="bad",this.data.status_txt="connecting",this.rws=new gt(t,[],{debug:!1,startClosed:!0}),this.rws.addEventListener("open",(()=>this.onOpen())),this.rws.addEventListener("close",(()=>this.onClose())),this.rws.addEventListener("message",(t=>this.onMessage(t))),this.rws.addEventListener("error",(t=>this.onError(t))),this.rws.reconnect()}stop(){this.rws&&(console.log("WS: closing"),this.rws.close()),this.rws=null,this.data.status="off",this.data.status_txt="off"}onOpen(){console.log("WS opened"),this.data.status="ok",this.data.status_txt="connected",this.rws.send('{"topic":"$ctrl", "payload":"start"}')}onClose(){console.log("WS closed"),this.data.status=this.rws?"bad":"off"}onMessage(t){let e;try{e=JSON.parse(t.data)}catch(n){return void console.log("WS rx:",n)}"object"==typeof e&&"string"==typeof e.topic&&void 0!==e.payload?(console.log("WS rx:",e),this.recvMsg(e),this.data.status="ok",this.data.status_txt="connected"):console.log("WS rx: message is missing topic and/or payload",e)}onError(t){console.log("WS rx error:",t.message||" ... no details"),this.data.status="bad",this.data.status_txt=t.message?`error: ${t.message}`:"error"}serverSend(t,e){this.rws&&this.rws.send(JSON.stringify({topic:t,payload:e}))}}const pt={};var bt=G({name:"Connections",components:{DemoSettings:V,WebsockSettings:st},data:()=>({show_dialog:!1,demo_connection:null,websock_connection:null}),computed:{icon_color(){let t=0,e=0;for(const n of[this.demo_connection,this.websock_connection])if(n)switch(n.data.status){case"ok":t++;break;case"bad":e++}return t?e?"warning":"success":e?"error":"grey"},demo_config(){return this.$config.conn?this.$config.conn.demo:void 0},websock_config(){return this.$config.conn?this.$config.conn.websock:void 0}},inject:["$store","$config"],created(){console.log("Connection: created");const t=this.$config.conn;this.$set(t,"demo",{enabled:!0}),this.$set(t,"websock",{enabled:!1,address:""});const e=this.$root.params;e&&e.get("ws")&&(t.demo.enabled=!0,t.websock.address=e.get("ws"),t.websock.enabled=!0),console.log("Initial connection config:",JSON.stringify(t))},mounted(){console.log("Connection: mounted, websock_config:",this.websock_config),this.demo_connection=new et(void 0,this.handleMsg),this.demo_config&&this.demo_config.enabled&&this.demo_connection.start(),this.websock_connection=new ft(void 0,this.handleMsg),this.websock_config&&this.websock_config.enabled&&this.websock_config.address&&this.websock_connection.start(this.websock_config.address),this.$root.serverSend=(t,e)=>this.serverSend(t,e)},beforeDestroy(){console.log("Connection: beforeDestroy"),this.demo_connection&&this.demo_connection.stop(),this.websock_connection&&this.websock_connection.stop()},methods:{showDialog(t){this.show_dialog=!0,t.stopPropagation()},handleMsg(t){if("topic"in t&&"payload"in t){if("$config"===t.topic){const e=t.payload;if(console.log(`*** config for '${e.dash.title}' received:`,`${Object.keys(e.tabs).length} tabs, ${Object.keys(e.grids).length} grids,`,`${Object.keys(e.widgets).length} widgets`),this.$config.dash.title)return void console.log("Already got config, dropping message");if(!t.payload||!t.payload.dash)return console.log("*** No or broken config, clearing! (got:",t.payload),void this.$store.initDash()}this.$store.insertData(t.topic,t.payload)}else console.log("Message w/out topic/payload:",t)},serverSend(t,e){t.startsWith("$demo")?this.$store.insertData(t,e):this.websock_connection&&this.websock_connection.serverSend(t,e)}}},(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"mx-2"},[n(b,{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var o=e.on;return[n(u,t._g({attrs:{small:"",icon:"",color:t.icon_color}},Object.assign({},{click:t.showDialog},o)),[n(_,[t._v("mdi-network")])],1)]}}])},[n("span",[t._v("Server connections")])]),n(m,{model:{value:t.show_dialog,callback:function(e){t.show_dialog=e},expression:"show_dialog"}},[n(w,[n(v,{staticClass:"d-flex"},[n("span",[t._v("Server Connections")]),n(y),n(u,{attrs:{elevation:"0",icon:""},on:{click:function(e){t.show_dialog=!1}}},[n(_,[t._v("mdi-close")])],1)],1),n(k,[n($,{attrs:{justify:"space-between"}},[n("websock-settings",{attrs:{connection:t.websock_connection,config:t.websock_config}}),n("demo-settings",{attrs:{connection:t.demo_connection,config:t.demo_config}}),n(h,{attrs:{cols:"12",md:"5"}},[n("h3",[t._v("UIbuilder")]),t._v(" Connect to Node-Red using UIbuilder's socket.io "),n(f,{attrs:{disabled:"",label:"enabled (not yet implemented)","hide-details":""}}),n(p,{attrs:{label:"Node-Red server address","persistent-hint":"",hint:"http://localhost:1880/ws/fd"}}),n(p,{attrs:{label:"UIbuilder namespace","persistent-hint":"",hint:"URL field in the uibuilder node's properties in node-red"}})],1)],1)],1)],1)],1)],1)}),[],!1,(function(t){for(let e in pt)this[e]=pt[e]}),null,null,null);bt.options.__file="src/components/connections.vue";var _t=bt.exports;const mt={};var wt=G({name:"Dash",components:{Connections:_t},inject:["$config","$store","palette"],data:()=>({appTitle:"FlexDash",sidebar:!1,tab_ix:null,tab_edit:!1,settings_menu:null,settings:{edit:"Edit mode",theme:"Toggle theme"}}),computed:{gotConfig(){return void 0!==this.$config.dash.title},dash(){return this.gotConfig?this.$config.dash:{}},dash_tabs(){return this.dash.tabs||[]},tab(){return this.tab_id?this.tabs[this.tab_id]:{}},tab_id(){return null!=this.tab_ix?this.dash_tabs[this.tab_ix]:null},tabs(){return this.gotConfig?this.$config.tabs:{}},grids(){return this.gotConfig?this.$config.grids:{}},theme(){return this.$vuetify.theme.dark?"dark":"light"},canUndo(){return this.$store.undo.buf.length>0}},watch:{tabs(t){this.tab_ix>=t.length&&(this.tab_ix=t.length-1)}},mounted(){if(console.log(`FlexDash! route=${this.$root.route} params=${this.$root.params}`),this.$root.route.match(/^#[0-9]+$/)){const t=Number.parseInt(this.$root.route.substr(1),10);t>=0&&t<this.dash_tabs.length&&(this.tab_ix=t)}else if(this.$root.route.startsWith("#")){const t=this.$root.route.substr(1);this.dash_tabs.forEach(((e,n)=>{console.log(`Route match: ix=${n} title=${this.tabs[e].title} icon=${this.tabs[e].icon}`),t!=this.tabs[e].title&&t!=this.tabs[e].icon||(this.tab_ix=n)}))}const t=J(0,100);this.intvl=window.setInterval((()=>this.$store.insertData("$demo_random",t())),3e3)},beforeDestroy(){window.clearInterval(this.intvl)},provide(){const t=this;return{sendSrv(e,n){t.$refs.uib.send({topic:e,payload:n})}}},methods:{addTab(t){const e=this.$store.addTab();t.stopPropagation(),this.$nextTick((()=>{this.tab_ix=e,this.tab_edit=!0}))},deleteTab(){this.$store.deleteTab(this.tab_ix),this.tab_ix>=this.$config.dash.tabs.length-1&&(this.tab_ix=this.$config.dash.tabs.length-1),this.tab_edit=!1},handleEdit(t,e){console.log("handleEdit",t,e);const n={};n[t]=e,this.$store.updateTab(this.tab_id,n)},moveTab(t){const e=this.tab_ix;if(!(e+t>=0&&e+t<this.dash.tabs.length))return;let n=[...this.dash.tabs],o=n[e];n[e]=n[e+t],n[e+t]=o,this.$store.updateDash({tabs:n}),this.tab_ix+=t,this.gotConfig=!1,this.$nextTick((()=>this.gotConfig=!0))},addGrid(){this.$store.addGrid(this.tab_id)},deleteGrid(t,e){this.$store.deleteGrid(t,e)}}},(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n(x,[t.gotConfig?n(E,{attrs:{app:"","mini-variant":"",clipped:""},model:{value:t.sidebar,callback:function(e){t.sidebar=e},expression:"sidebar"}},[n("div",[n(O,{attrs:{vertical:""},model:{value:t.tab_ix,callback:function(e){t.tab_ix=e},expression:"tab_ix"}},t._l(t.dash_tabs,(function(e){return n(D,{key:e,staticClass:"px-0",staticStyle:{"min-width":"auto"}},[n(_,{attrs:{large:""}},[t._v("mdi-"+t._s(t.tabs[e].icon))])],1)})),1)],1)]):t._e(),n(C,{attrs:{dense:"",app:"","clipped-left":"",color:"surface"}},[n("span",{staticClass:"hidden-sm-and-up"},[n(S,{on:{click:function(e){t.sidebar=!t.sidebar}}})],1),n(T,{staticClass:"text-h4 font-weight-bold text--secondary flex-shrink-0 mr-3",staticStyle:{"font-variant":"small-caps"}},[t._v(" "+t._s(t.gotConfig?t.dash.title:"FlexDash")+" ")]),t.gotConfig?n(O,{staticClass:"hidden-xs-only",attrs:{"icons-and-text":"","center-active":""},model:{value:t.tab_ix,callback:function(e){t.tab_ix=e},expression:"tab_ix"}},[t._l(t.dash_tabs,(function(e,o){return n(D,{key:e+o,class:{"is-active":o==t.tab_ix},attrs:{id:"tab-"+e,xhref:"#tab"+o}},[t._v(" "+t._s(t.tabs[e].title)+" "),n(_,{staticClass:"mb-0",attrs:{large:!t.tabs[e].title}},[t._v("mdi-"+t._s(t.tabs[e].icon))]),n("div",{staticStyle:{position:"absolute","z-index":"5",right:"0",top:"0.5ex"}},[t.$root.editMode&&o==t.tab_ix?n(u,{attrs:{small:"",icon:""},on:{click:function(e){e.stopPropagation(),t.tab_edit=!t.tab_edit}}},[n(_,{attrs:{small:""}},[t._v("mdi-pencil")])],1):t._e()],1)],1)})),t.$root.editMode?n(u,{staticClass:"my-auto ml-6",attrs:{"x-small":"",fab:""},on:{click:function(e){return t.addTab(e)}}},[n(_,[t._v("mdi-plus")])],1):t._e()],2):t._e(),n(y),t.$root.editMode?n(b,{attrs:{bottom:"",disabled:!t.canUndo},scopedSlots:t._u([{key:"activator",fn:function(e){var o=e.on,s=e.attrs;return[n(u,t._g(t._b({attrs:{icon:"",disabled:!t.canUndo},on:{click:function(e){return t.$store.performUndo()}}},"v-btn",s,!1),o),[n(_,[t._v("mdi-undo")])],1)]}}],null,!1,3463734905)},[n("span",[t._v("undo "+t._s(t.canUndo&&t.$store.undo.buf[t.$store.undo.buf.length-1].tagline))])]):t._e(),n("connections"),n(j,{attrs:{"offset-x":"","min-width":"10em"},scopedSlots:t._u([{key:"activator",fn:function(e){var o=e.on,s=e.attrs;return[n(u,t._g(t._b({attrs:{icon:""}},"v-btn",s,!1),o),[n(_,[t._v("mdi-cog")])],1)]}}]),model:{value:t.settings_menu,callback:function(e){t.settings_menu=e},expression:"settings_menu"}},[n(I,{attrs:{dense:""}},[n(L,[n(N,{attrs:{inset:"",label:"Edit"},model:{value:t.$root.editMode,callback:function(e){t.$set(t.$root,"editMode",e)},expression:"$root.editMode"}})],1),n(L,[n(N,{attrs:{inset:"",label:"Dark"},model:{value:t.$vuetify.theme.dark,callback:function(e){t.$set(t.$vuetify.theme,"dark",e)},expression:"$vuetify.theme.dark"}})],1)],1)],1)],1),n(j,{attrs:{"offset-y":"","allow-overflow":"",activator:"#tab-"+t.tab_id,"max-width":"30ex","content-class":"popup-spacer","close-on-content-click":!1},model:{value:t.tab_edit,callback:function(e){t.tab_edit=e},expression:"tab_edit"}},[n(w,{attrs:{color:"surface"}},[n(k,{staticClass:"d-flex px-2"},[n(b,{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var o=e.on;return[n(u,t._g({attrs:{small:"",icon:""},on:{click:function(e){return t.moveTab(-1)}}},o),[n(_,[t._v("mdi-arrow-left-bold")])],1)]}}])},[n("span",[t._v("Move tab left")])]),n(b,{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var o=e.on;return[n(u,t._g({attrs:{small:"",icon:""},on:{click:function(e){return t.moveTab(1)}}},o),[n(_,[t._v("mdi-arrow-right-bold")])],1)]}}])},[n("span",[t._v("Move tab right")])]),n(y),n(u,{staticClass:"mx-auto",attrs:{small:""},on:{click:t.deleteTab}},[t._v("Delete tab")]),n(y),n(u,{attrs:{small:"",elevation:"0",icon:""},on:{click:function(e){t.tab_edit=!1}}},[n(_,[t._v("mdi-close")])],1)],1),n(k,{staticClass:"d-flex flex-column"},[n(p,{staticClass:"flex-grow-0",attrs:{dense:"",label:"icon","persistent-hint":"",hint:"yes",value:t.tab.icon},on:{input:function(e){return t.handleEdit("icon",e)}},scopedSlots:t._u([{key:"message",fn:function(){return[n("span",[t._v("See "),n("a",{attrs:{target:"_blank",href:"https://materialdesignicons.com"}},[t._v(" materialdesignicons.com "),n(_,{attrs:{color:"primary","x-small":""}},[t._v("mdi-open-in-new")])],1)])]},proxy:!0}])}),n(p,{staticClass:"flex-grow-0 mt-6",attrs:{dense:"",label:"tab title",value:t.tab.title},on:{input:function(e){return t.handleEdit("title",e)}}}),n(u,{staticClass:"mx-auto",attrs:{small:""},on:{click:t.addGrid}},[t._v("Add grid")])],1)],1)],1),n(R,[t.gotConfig?n(P,{model:{value:t.tab_ix,callback:function(e){t.tab_ix=e},expression:"tab_ix"}},[n("div",{style:{backgroundColor:t.$vuetify.theme.themes[t.theme].background}},t._l(t.dash_tabs,(function(e){return n(M,{key:e,class:{"is-active":e==t.tab_id}},t._l(t.tabs[e].grids,(function(o,s){return n(t.grids[o].kind in t.palette.grids?t.grids[o].kind:"div",{key:o,tag:"component",attrs:{id:o},on:{delete:function(n){return t.deleteGrid(e,s)}}})})),1)})),1)]):n("div",[t._v(" LOADING... ")])],1)],1)}),[],!1,(function(t){for(let e in mt)this[e]=mt[e]}),null,null,null);wt.options.__file="src/dash.vue";var vt=wt.exports;d.config.productionTip=!1;const yt=d.observable({widgets:{},grids:{},count:0});function kt(t,e){for(const n in e)e[n]().then((e=>{const o=e.default.name;if(!o)throw Error(`Loading ${n} resulted in 'undefined'!?`);console.log(`Loaded ${o} from ${n}`),d.component(o,e.default),d.set(t,o,e.default)})).catch((t=>{console.log(`Error glob-loading ${n}:`,t)}))}kt(yt.widgets,{"/src/widgets/gauge.vue":()=>B((()=>import("./gauge.20519a1b.js")),["/flexdash/assets/gauge.20519a1b.js","/flexdash/assets/gauge.0b2e3fce.css","/flexdash/assets/vuetify.50e96a45.js","/flexdash/assets/vuetify.616247a7.css","/flexdash/assets/vue.1457ee3a.js"]),"/src/widgets/markdown.vue":()=>B((()=>import("./markdown.ceea6296.js")),["/flexdash/assets/markdown.ceea6296.js","/flexdash/assets/md.a360188b.js","/flexdash/assets/md.1a41a622.css","/flexdash/assets/vuetify.50e96a45.js","/flexdash/assets/vuetify.616247a7.css","/flexdash/assets/vue.1457ee3a.js"]),"/src/widgets/push-button.vue":()=>B((()=>import("./push-button.119ceda1.js")),["/flexdash/assets/push-button.119ceda1.js","/flexdash/assets/push-button.868d2fbe.css","/flexdash/assets/vuetify.50e96a45.js","/flexdash/assets/vuetify.616247a7.css","/flexdash/assets/vue.1457ee3a.js"]),"/src/widgets/random-array.vue":()=>B((()=>import("./random-array.4c13b3e3.js")),["/flexdash/assets/random-array.4c13b3e3.js","/flexdash/assets/vuetify.50e96a45.js","/flexdash/assets/vuetify.616247a7.css","/flexdash/assets/vue.1457ee3a.js"]),"/src/widgets/random-value.vue":()=>B((()=>import("./random-value.9753c06c.js")),["/flexdash/assets/random-value.9753c06c.js","/flexdash/assets/random-value.db7f20ba.css","/flexdash/assets/vuetify.50e96a45.js","/flexdash/assets/vuetify.616247a7.css","/flexdash/assets/vue.1457ee3a.js"]),"/src/widgets/sparkchart.vue":()=>B((()=>import("./sparkchart.a6211110.js")),["/flexdash/assets/sparkchart.a6211110.js","/flexdash/assets/vuetify.50e96a45.js","/flexdash/assets/vuetify.616247a7.css","/flexdash/assets/vue.1457ee3a.js"]),"/src/widgets/stat.vue":()=>B((()=>import("./stat.d1b631d8.js")),["/flexdash/assets/stat.d1b631d8.js","/flexdash/assets/vuetify.50e96a45.js","/flexdash/assets/vuetify.616247a7.css","/flexdash/assets/vue.1457ee3a.js"]),"/src/widgets/time-plot-raw.vue":()=>B((()=>import("./time-plot-raw.e7f382fc.js")),["/flexdash/assets/time-plot-raw.e7f382fc.js","/flexdash/assets/time-plot-raw.180d2306.css","/flexdash/assets/vue.1457ee3a.js","/flexdash/assets/vuetify.50e96a45.js","/flexdash/assets/vuetify.616247a7.css"]),"/src/widgets/time-plot.vue":()=>B((()=>import("./time-plot.51d76e34.js")),["/flexdash/assets/time-plot.51d76e34.js","/flexdash/assets/vue.1457ee3a.js","/flexdash/assets/vuetify.50e96a45.js","/flexdash/assets/vuetify.616247a7.css"]),"/src/widgets/toggle.vue":()=>B((()=>import("./toggle.54333a07.js")),["/flexdash/assets/toggle.54333a07.js","/flexdash/assets/vuetify.50e96a45.js","/flexdash/assets/vuetify.616247a7.css","/flexdash/assets/vue.1457ee3a.js"])}),kt(yt.grids,{"./grids/fixed-grid.vue":()=>B((()=>import("./fixed-grid.66581f80.js")),["/flexdash/assets/fixed-grid.66581f80.js","/flexdash/assets/fixed-grid.f005f114.css","/flexdash/assets/vuetify.50e96a45.js","/flexdash/assets/vuetify.616247a7.css","/flexdash/assets/vue.1457ee3a.js","/flexdash/assets/md.a360188b.js","/flexdash/assets/md.1a41a622.css"])});const $t=new d({vuetify:F,data:{editMode:!1,route:window.location.hash,params:new URL(document.location).searchParams,serverSend:null},provide:{$config:Z.config,$store:Z,palette:yt},render:t=>t(vt)}).$mount("#app");window.addEventListener("popstate",(()=>{const t=new URL(document.location).searchParams;console.log(`POP! hash=${window.location.hash} qstring=${t}`),$t.route=window.location.hash,$t.params=t})),$t.$mount("#app");export{G as n,J as r,H as w};
