(function(t){function e(e){for(var n,r,s=e[0],c=e[1],u=e[2],d=0,f=[];d<s.length;d++)r=s[d],Object.prototype.hasOwnProperty.call(o,r)&&o[r]&&f.push(o[r][0]),o[r]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(t[n]=c[n]);l&&l(e);while(f.length)f.shift()();return a.push.apply(a,u||[]),i()}function i(){for(var t,e=0;e<a.length;e++){for(var i=a[e],n=!0,s=1;s<i.length;s++){var c=i[s];0!==o[c]&&(n=!1)}n&&(a.splice(e--,1),t=r(r.s=i[0]))}return t}var n={},o={app:0},a=[];function r(e){if(n[e])return n[e].exports;var i=n[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=t,r.c=n,r.d=function(t,e,i){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(i,n,function(e){return t[e]}.bind(null,n));return i},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/flexdash/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=e,s=s.slice();for(var u=0;u<s.length;u++)e(s[u]);var l=c;a.push([0,"chunk-vendors"]),i()})({0:function(t,e,i){t.exports=i("56d7")},"07c0":function(t,e,i){"use strict";i.r(e);var n=i("3db1"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(a);e["default"]=o.a},1:function(t,e){},"1acb":function(t,e,i){"use strict";i.r(e);var n=i("bf03"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(a);e["default"]=o.a},"1ec4":function(t,e,i){"use strict";i.r(e);var n=i("d9ba"),o=i("1acb");for(var a in o)["default"].indexOf(a)<0&&function(t){i.d(e,t,(function(){return o[t]}))}(a);var r=i("2877"),s=i("6544"),c=i.n(s),u=i("7f2e"),l=Object(r["a"])(o["default"],n["a"],n["b"],!1,null,null,null);e["default"]=l.exports,c()(l,{VSparkline:u["a"]})},"254b":function(t,e,i){"use strict";i.r(e);var n=i("275f"),o=i("9d9d");for(var a in o)["default"].indexOf(a)<0&&function(t){i.d(e,t,(function(){return o[t]}))}(a);var r=i("2877"),s=i("6544"),c=i.n(s),u=i("99d9"),l=Object(r["a"])(o["default"],n["a"],n["b"],!1,null,null,null);e["default"]=l.exports,c()(l,{VCardTitle:u["b"]})},"26df":function(t,e){t.exports={name:"Stat",props:{unit:String,value:{default:null}},computed:{unitTxt:function(){return"--"===this.value?"":this.unit},valTxt:function(){return"number"==typeof this.value?Math.round(10*this.value)/10:null===this.value?"--":this.value}}}},"275f":function(t,e,i){"use strict";i.d(e,"a",(function(){return n})),i.d(e,"b",(function(){return o}));var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-card-title",{staticClass:"headline pa-0"},[i("span",{staticClass:"ma-auto"},[t._v(t._s(t.valTxt)),i("span",{staticClass:"unit"},[t._v(t._s(t.unitTxt))])])])},o=[]},"322f":function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticStyle:{display:"contents"}},[t.$root.editMode?i("v-toolbar",{staticClass:"editmode",attrs:{dense:"",color:"surface"}},[i("div",[i("v-chip",{attrs:{small:""}},[t._v("fixed size grid")])],1),i("div",[i("v-menu",{attrs:{"offset-y":""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,o=e.attrs;return[i("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var a=e.on;return[i("v-btn",t._g(t._b({attrs:{small:"",icon:"",color:"primary"}},"v-btn",o,!1),Object.assign({},a,n)),[i("v-icon",[t._v("mdi-card-plus")])],1)]}}],null,!0)},[i("span",[t._v("Add a widget to the end of the grid")])])]}}],null,!1,4148765622),model:{value:t.add_menu,callback:function(e){t.add_menu=e},expression:"add_menu"}},[i("v-list",[i("v-subheader",[t._v("Add Widget to the end of the grid")]),t._l(t.palette(),(function(e){return i("v-list-item",{key:e,on:{click:function(i){return t.$store.addWidget(t.id,e)}}},[i("v-list-item-title",[t._v(t._s(e))])],1)}))],2)],1)],1),i("v-spacer")],1):t._e(),i("v-container",{staticClass:"g-grid-small",attrs:{fluid:""}},t._l(t.grid.widgets,(function(e,n){return i("widget-edit",{key:e,attrs:{id:e,grid_id:t.id,edit_active:n==t.edit_ix},on:{edit:function(e){return t.toggleEdit(n,e)},move:function(e){return t.moveWidget(n,e)},delete:function(e){return t.deleteWidget(n)}}})})),1)],1)},o=[],a=i("2909"),r=(i("b64b"),i("99af"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{style:t.widgetStyle},[i("v-menu",{attrs:{value:t.edit_active&&t.reposition,"offset-y":"","content-class":"popup-spacer","close-on-content-click":!1,"close-on-click":!1},scopedSlots:t._u([{key:"activator",fn:function(e){return[i("widget-wrap",{attrs:{config:t.widget,suppressOutput:t.suppressOutput,color:t.edit_active?"highlight":"","not-used":e},on:{edit:t.toggleEdit}})]}}])},[i("v-card",{attrs:{color:"panel"}},[i("v-card-title",{staticClass:"d-flex align-baseline"},[i("span",[t._v("Edit "+t._s(t.widget.kind)+" widget")]),i("v-text-field",{staticClass:"ml-3 mt-0 text-h6 flex-grow-0",attrs:{dense:"",prefix:'"',suffix:'"',value:t.widget.static["title"],"hide-details":!0},on:{input:function(e){return t.handleEdit("static","title",e)}}}),i("v-spacer"),i("v-btn",{attrs:{elevation:"0",icon:""},on:{click:t.endEdit}},[i("v-icon",[t._v("mdi-close")])],1)],1),t.edit_active?i("v-card-text",[i("v-container",{attrs:{fluid:""}},[i("v-row",{attrs:{align:"center"}},[i("v-col",{staticClass:"d-flex",attrs:{cols:"4"}},[i("v-btn",{attrs:{small:""},on:{click:function(e){return t.$emit("delete")}}},[t._v("Delete widget")])],1),i("v-col",{staticClass:"d-flex",attrs:{cols:"4"}},[i("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on;return[i("v-btn",t._g({staticClass:"ml-2",attrs:{small:"",icon:""},on:{click:function(e){return t.moveWidget(-1)}}},n),[i("v-icon",[t._v("mdi-arrow-up-bold")])],1)]}}],null,!1,4110266859)},[i("span",[t._v("Move widget towards the top-left of the grid")])]),i("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on;return[i("v-btn",t._g({attrs:{small:"",icon:""},on:{click:function(e){return t.moveWidget(1)}}},n),[i("v-icon",[t._v("mdi-arrow-down-bold")])],1)]}}],null,!1,171324591)},[i("span",[t._v("Move widget towards the bottom-right of the grid")])])],1),i("v-col",{staticClass:"d-flex",attrs:{cols:"4"}},[i("v-btn",{staticClass:"ml-2",attrs:{small:"",icon:""},on:{click:function(e){return t.adjustRows(-1)}}},[i("v-icon",[t._v("mdi-minus")])],1),i("v-chip",{attrs:{small:""}},[t._v(t._s(t.widget.rows)+" row"+t._s(t.widget.rows>1?"s":""))]),i("v-btn",{attrs:{small:"",icon:""},on:{click:function(e){return t.adjustRows(1)}}},[i("v-icon",[t._v("mdi-plus")])],1),i("v-btn",{staticClass:"ml-2",attrs:{small:"",icon:""},on:{click:function(e){return t.adjustCols(-1)}}},[i("v-icon",[t._v("mdi-minus")])],1),i("v-chip",{attrs:{small:""}},[t._v(t._s(t.widget.cols)+" col"+t._s(t.widget.cols>1?"s":""))]),i("v-btn",{attrs:{small:"",icon:""},on:{click:function(e){return t.adjustCols(1)}}},[i("v-icon",[t._v("mdi-plus")])],1)],1)],1),i("v-row",{attrs:{align:"center"}},t._l(t.edit_props,(function(e){return i("v-col",{key:e,staticClass:"d-flex",attrs:{cols:"12",sm:"6",md:"4"}},[i("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(n){var o=n.on,a=n.attrs;return[i("v-btn-toggle",{staticClass:"mt-2 mr-1",attrs:{mandatory:"",dense:"","background-color":"rgba(0,0,0,0)",color:"primary"},model:{value:t.prop_static[e],callback:function(i){t.$set(t.prop_static,e,i)},expression:"prop_static[prop]"}},[i("v-btn",t._g(t._b({attrs:{"x-small":"",icon:""}},"v-btn",a,!1),o),[i("v-icon",[t._v("mdi-link-variant")])],1),i("v-btn",t._g(t._b({attrs:{"x-small":"",icon:""}},"v-btn",a,!1),o),[i("v-icon",[t._v(t._s(t.prop_info[e].icon))])],1)],1)]}}],null,!0)},[i("span",[t._v("Toggle dynamic link vs. literal value")])]),t.prop_static[e]?t.prop_info[e].type===Number?i("v-text-field",{attrs:{label:e,type:"number",dense:"",hint:t.prop_info[e].hint,value:t.propVal(e)},on:{input:function(i){return t.handleEdit("static",e,i)}}}):t.prop_info[e].type===Boolean?i("v-switch",{staticClass:"mt-0 ml-2",attrs:{label:e,hint:t.prop_info[e].hint,"input-value":t.propVal(e)},on:{change:function(i){return t.handleEdit("static",e,i)}}}):t.prop_info[e].type===Array?i("v-text-field",{attrs:{label:e,dense:"",value:t.widget.static[e]||t.prop_info[e].default},on:{input:function(i){return t.handleEdit("static",e,i)}}}):(t.prop_info[e].type,i("v-text-field",{attrs:{label:e,dense:"",hint:t.prop_info[e].hint,value:t.widget.static[e]||t.prop_info[e].default},on:{input:function(i){return t.handleEdit("static",e,i)}}})):i("v-combobox",{attrs:{label:e,clearable:"",dense:"","persistent-hint":"",hint:"variable pathname (/-sep)",items:t.sdKeys,value:t.widget.dynamic[e]},on:{input:function(i){return t.handleEdit("dynamic",e,i)}}})],1)})),1)],1)],1):t._e()],1)],1)],1)}),s=[],c=(i("4de4"),i("caad"),i("2532"),i("a9e3"),i("b0c0"),i("c1f9"),i("d81d"),i("c35a"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-card",{attrs:{color:t.color}},["title"in t.child_props?t.$root.editMode?i("div",{attrs:{"display:content":""}},[i("div",{staticStyle:{position:"absolute","z-index":"5",right:"0",top:"0.5ex"}},[i("v-btn",{staticClass:"justify-end align-start mt-n1",attrs:{small:"",icon:""},on:{click:t.handleEdit}},[i("v-icon",{attrs:{small:""}},[t._v("mdi-pencil")])],1)],1)]):t._e():i("v-card-text",{staticClass:"d-flex pa-0 pt-1 mb-n1"},[t.title?i("span",{staticClass:"mx-auto"},[t._v(t._s(t.title))]):t._e(),t.$root.editMode?i("v-btn",{staticClass:"justify-end align-start mt-n1",attrs:{small:"",icon:""},on:{click:t.handleEdit}},[i("v-icon",{attrs:{small:""}},[t._v("mdi-pencil")])],1):t._e()],1),i(t.config.kind,t._b({ref:"comp",tag:"component",on:{send:function(e){return t.sendData(e)}}},"component",t.bindings,!1))],1)}),u=[],l=i("53ca"),d=(i("159b"),i("d3b7"),i("25f0"),{name:"WidgetWrap",props:{suppressOutput:{type:Boolean,default:!0},color:{type:String,default:void 0},config:{type:Object,required:!0}},data:function(){return{watchers:[],bindings:{}}},computed:{title:function(){return this.bindings.title||"--"},child_props:function(){var t=window.widgetPalette;return this.config.kind in t&&t[this.config.kind].props||{}}},watch:{config:{immediate:!0,deep:!0,handler:function(t){this.genBindings(t)}}},inject:["sendSrv","$store"],methods:{addDynBinding:function(t,e){var i=this;e in this.$store.sd||i.$set(this.$store.sd,e,void 0);var n=this.$watch((function(){return i.$store.sd[e]}),(function(e){i.updateBindingValue(t,e)}),{deep:!0,immediate:!0});return n},removeWatchers:function(){this.watchers.forEach((function(t){t()})),this.watchers.length=0},genBindings:function(t){var e=this;this.removeWatchers(),this.bindings={},t&&(Object.keys(t.static||{}).forEach((function(i){void 0!==t.static[i]&&e.$set(e.bindings,i,t.static[i])})),Object.keys(t.dynamic||{}).forEach((function(i){void 0!==t.dynamic[i]&&e.watchers.push(e.addDynBinding(i,t.dynamic[i]))})))},updateBindingValue:function(t,e){if(t in this.child_props){var i=this.child_props[t].type;if(i===Boolean)"number"===typeof e?e=!!e:"string"===typeof e?(e=e.toLowerCase(),e=["true","ok","1","yes"].includes(e)):"boolean"!==typeof e&&(e=void 0);else if(i===Number)"string"===typeof e?e=parseFloat(e):"boolean"===typeof e?e=e?1:0:"number"!==typeof e&&(e=void 0),void 0!==e&&(e=Number.parseFloat(e.toPrecision(4)));else if(i===String)Object(l["a"])(e)===Number?e=e.toString():Object(l["a"])(e)!==String&&(e=JSON.stringify(e));else if((i===Array||i===Object)&&"string"===typeof e)try{e=JSON.parse(e)}catch(n){e=void 0,console.log("Cannot convert string value for ".concat(t," to ").concat(i.name))}this.$set(this.bindings,t,e)}else console.log("Warning: updating value for ".concat(t,", but ").concat(this.config.kind," has no ").concat(t,":"),JSON.stringify(this.child_props))},handleEdit:function(){console.log("handleEdit() in widget-wrap"),this.$emit("edit","toggle")},sendData:function(t){var e=this.config.output;!this.suppressOutput&&e?(console.log("Widget ".concat(this.config.kind,"[").concat(this.config.id,"] sending ").concat(e," <-"),t),this.sendSrv(e,t)):console.log("Output of widget ".concat(this.config.kind,"[").concat(this.config.id,"] suppressed"))}}}),f=d,h=(i("db64"),i("2877")),p=i("6544"),g=i.n(p),v=i("8336"),b=i("b0af"),m=i("99d9"),_=i("132d"),y=Object(h["a"])(f,c,u,!1,null,"647c50c6",null),w=y.exports;g()(y,{VBtn:v["a"],VCard:b["a"],VCardText:m["a"],VIcon:_["a"]});var k={name:"WidgetEdit",components:{WidgetWrap:w},inject:["$store"],props:{id:{type:String,required:!0},grid_id:{type:String,require:!0},edit_active:{type:Boolean,default:!1}},data:function(){return{suppressOutput:!0,prop_static:{},saved_widget:null,reposition:!0}},computed:{widget:function(){return this.$store.widgetByID(this.id)},sdKeys:function(){return Object.keys(this.$store.sd).sort()},edit_props:function(){var t=Object.keys(this.child_props);return t.filter((function(t){return"title"!==t})).sort()},prop_info:function(){var t={String:"mdi-format-quote-close",Number:"mdi-numeric",Boolean:"mdi-yin-yang",Array:"mdi-code-brackets",Object:"mdi-code-braces"},e={},i=this.child_props;for(var n in i){var o=i[n].type||String;[String,Number,Boolean,Array,Object].includes(o)||(o=String);var a=o.name;void 0!==i[n].default&&(a+=", default: ".concat(i[n].default));var r=t[o.name];e[n]={type:o,default:i[n].default,validator:i[n].validator,hint:a,icon:r}}return e},child_props:function(){var t=window.widgetPalette;return this.widget.kind in t&&t[this.widget.kind].props||{}},widgetStyle:function(){var t="grid-row-start: span ".concat(this.widget.rows||1),e="grid-column-start: span ".concat(this.widget.cols||1);return"".concat(t,"; ").concat(e,";")}},watch:{edit_active:function(t){if(t){this.saved_widget=this.widget;var e=this;this.prop_static=Object.fromEntries(Object.keys(e.child_props).map((function(t){return[t,1-(t in e.widget.dynamic)]})))}else this.saved_widget=null}},methods:{propVal:function(t){return void 0!==this.widget.static[t]?this.widget.static[t]:this.prop_info[t].default},toggleEdit:function(){this.$emit("edit",!this.edit_active)},endEdit:function(){this.$emit("edit",!1)},handleEdit:function(t,e,i){if(t in this.widget){if("title"!=e){if(!(e in this.child_props))return;this.child_props[e].type===Number&&"string"===typeof i&&(i=Number.parseFloat(i))}this.$store.updateWidgetProp(this.id,t,e,i)}},adjustRows:function(t){var e=this,i=this.widget;i.rows=(i.rows||1)+t,i.rows<1&&(i.rows=1),i.rows>16&&(i.rows=16),this.reposition=!1,this.$nextTick((function(){e.reposition=!0}))},adjustCols:function(t){var e=this,i=this.widget;i.cols=(i.cols||1)+t,i.cols<1&&(i.cols=1),i.cols>16&&(i.cols=16),this.reposition=!1,this.$nextTick((function(){e.reposition=!0}))},moveWidget:function(t){var e=this;this.$emit("move",t),this.reposition=!1,this.$nextTick((function(){e.reposition=!0}))}}},C=k,x=(i("78fb"),i("a609")),O=i("cc20"),S=i("62ad"),D=i("2b5d"),$=i("a523"),j=i("e449"),T=i("0fd9"),E=i("2fa4"),N=i("b73d"),A=i("8654"),V=i("3a2f"),M=Object(h["a"])(C,r,s,!1,null,"4bfa0d74",null),I=M.exports;g()(M,{VBtn:v["a"],VBtnToggle:x["a"],VCard:b["a"],VCardText:m["a"],VCardTitle:m["b"],VChip:O["a"],VCol:S["a"],VCombobox:D["a"],VContainer:$["a"],VIcon:_["a"],VMenu:j["a"],VRow:T["a"],VSpacer:E["a"],VSwitch:N["a"],VTextField:A["a"],VTooltip:V["a"]});var P={name:"FixedGrid",components:{WidgetEdit:I},inject:["$store","$config"],props:{id:{type:String}},data:function(){return{add_menu:null,edit_ix:null}},computed:{grid:function(){return this.$store.gridByID(this.id)}},methods:{palette:function(){return console.log("Palette:",window.widgetPalette),Object.keys(window.widgetPalette)},toggleEdit:function(t,e){this.edit_ix=e?t:null},deleteWidget:function(t){this.$store.deleteWidget(this.id,t),this.endEdit()},moveWidget:function(t,e){if(console.log("Moving widget #".concat(t," by ").concat(e)),t+e>=0&&t+e<this.grid.widgets.length){var i=Object(a["a"])(this.grid.widgets),n=i[t];i[t]=i[t+e],i[t+e]=n,this.$store.updateGrid(this.id,{widgets:i}),this.edit_ix+=e}}}},B=P,R=(i("4a50"),i("d0ef"),i("8860")),L=i("da13"),W=i("5d23"),F=i("e0c7"),q=i("71d9"),U=Object(h["a"])(B,n,o,!1,null,"368226bd",null);e["default"]=U.exports;g()(U,{VBtn:v["a"],VChip:O["a"],VContainer:$["a"],VIcon:_["a"],VList:R["a"],VListItem:L["a"],VListItemTitle:W["b"],VMenu:j["a"],VSpacer:E["a"],VSubheader:F["a"],VToolbar:q["a"],VTooltip:V["a"]})},"34fc":function(t,e,i){"use strict";i("8896")},"3db1":function(t,e){t.exports={name:"Toggle",props:{value:{default:0},enabled:{default:!0},color:{default:"primary"},on_value:{default:!0},off_value:{default:!1},show_value:{default:!0}},data:function(){return{val:0}},computed:{bindings:function(){return{value:this.val,disabled:!this.enabled,color:this.color,trueValue:this.on_value,falseValue:this.off_value,label:this.show_value?this.label:void 0}},label:function(){var t=this.val==this.on_value?this.on_value:this.off_value;return"".concat(t)}},watch:{value:function(t){this.val=t}},methods:{change:function(t){console.log("toggle event:",t),this.$emit("send",t)}}}},"3eb2":function(t,e,i){"use strict";i.d(e,"a",(function(){return n})),i.d(e,"b",(function(){return o}));var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"d-flex"},[i("v-switch",t._b({staticClass:"ma-auto",on:{change:function(e){return t.change(e)}}},"v-switch",t.bindings,!1))],1)},o=[]},"467f":function(t,e,i){},"4a50":function(t,e,i){"use strict";i("7658")},"56d7":function(t,e,i){"use strict";i.r(e);i("e260"),i("e6cf"),i("cca6"),i("a79d"),i("c1f9"),i("d81d"),i("d3b7"),i("ddb0"),i("ac1f"),i("5319"),i("1276"),i("99af");var n=i("2b0e"),o=i("ce5b"),a=i.n(o);i("bf40");n["default"].use(a.a);var r=new a.a({theme:{options:{variations:!1,customProperties:!0},themes:{light:{background:"#f7f5f5",surface:"#fffdfd",panel:"#f4f2f2",primary:"#ad1625",primary_light:"#e5504d",primary_dark:"#760000",error:"#ec7422",highlight:"#fff5ce"},dark:{background:"#0b0808",surface:"#201d1d",panel:"#262424",primary:"#ad1625",primary_light:"#e5504d",primary_dark:"#760000",error:"#ec7422",highlight:"#716741"}}}}),s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-app",[i("v-app-bar",{attrs:{dense:"",app:"","clipped-left":"",flat:t.$root.editMode,color:"surface","extension-height":t.tab_edit?56:0},scopedSlots:t._u([t.tab_edit?{key:"extension",fn:function(){return[i("span",{staticClass:"ml-auto"}),i("v-icon",{staticClass:"ml-3 align-self-center",attrs:{large:""}},[t._v("mdi-"+t._s(t.tab_icon))]),i("v-text-field",{staticClass:"ml-0 flex-grow-0",attrs:{label:"icon",dense:"",hint:"yes","persistent-hint":""},scopedSlots:t._u([{key:"message",fn:function(){return[t._v(" See "),i("a",{attrs:{target:"_blank",href:"https://materialdesignicons.com"}},[t._v(" materialdesignicons.com "),i("v-icon",{attrs:{color:"primary","x-small":""}},[t._v("mdi-open-in-new")])],1)]},proxy:!0}],null,!1,3149174332),model:{value:t.tab_icon,callback:function(e){t.tab_icon=e},expression:"tab_icon"}}),i("v-btn",{staticClass:"ml-3 align-self-center",attrs:{small:"",color:"primary"},on:{click:t.handleSave}},[t._v("save")]),i("v-btn",{staticClass:"ml-1 align-self-center",attrs:{small:""},on:{click:t.handleCancel}},[t._v("cancel")]),i("v-btn",{staticClass:"ml-auto align-self-center",attrs:{small:""},on:{click:t.handleDeleteTab}},[t._v("delete tab")])]},proxy:!0}:null],null,!0)},[i("span",{staticClass:"hidden-sm-and-up"},[i("v-app-bar-nav-icon",{on:{click:function(e){t.sidebar=!t.sidebar}}})],1),i("v-toolbar-title",{staticClass:"text-h4 font-weight-bold text--secondary flex-shrink-0 mr-3",staticStyle:{"font-variant":"small-caps"}},[t._v(" "+t._s(this.gotConfig?t.dash.title:"FlexDash")+" ")]),t.gotConfig?i("v-tabs",{staticClass:"hidden-xs-only",model:{value:t.tab_ix,callback:function(e){t.tab_ix=e},expression:"tab_ix"}},[t._l(t.dash_tabs,(function(e,n){return i("v-tab",{key:e+n},[i("v-icon",{attrs:{large:""}},[t._v("mdi-"+t._s(t.tabs[e].icon))]),i("div",{staticStyle:{position:"absolute","z-index":"5",right:"0",top:"0.5ex"}},[t.$root.editMode&&n==t.tab_ix?i("v-btn",{attrs:{small:"",icon:""},on:{click:function(e){t.tab_edit=!t.tab_edit}}},[i("v-icon",{attrs:{small:""}},[t._v("mdi-pencil")])],1):t._e()],1)],1)})),t.$root.editMode?i("v-btn",{staticClass:"my-auto",attrs:{"x-small":"",fab:""},on:{click:t.handleAddTab}},[i("v-icon",[t._v("mdi-plus")])],1):t._e()],2):t._e(),i("v-tooltip",{attrs:{bottom:"",disabled:!t.canUndo},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,o=e.attrs;return[i("v-btn",t._g(t._b({attrs:{icon:"",disabled:!t.canUndo},on:{click:function(e){return t.$store.performUndo()}}},"v-btn",o,!1),n),[i("v-icon",[t._v("mdi-undo")])],1)]}}])},[i("span",[t._v("undo "+t._s(t.canUndo&&t.$store.undo.buf[t.$store.undo.buf.length-1].tagline))])]),i("demo",{on:{msg:t.handleMsg}}),i("uib",{ref:"uib",on:{msg:t.handleMsg}}),i("v-menu",{attrs:{"offset-x":"","min-width":"10em"},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,o=e.attrs;return[i("v-btn",t._g(t._b({attrs:{icon:""}},"v-btn",o,!1),n),[i("v-icon",[t._v("mdi-cog")])],1)]}}]),model:{value:t.settings_menu,callback:function(e){t.settings_menu=e},expression:"settings_menu"}},[i("v-list",{attrs:{dense:""}},[i("v-list-item",[i("v-switch",{attrs:{inset:"",label:"Edit"},model:{value:t.$root.editMode,callback:function(e){t.$set(t.$root,"editMode",e)},expression:"$root.editMode"}})],1),i("v-list-item",[i("v-switch",{attrs:{inset:"",label:"Dark"},model:{value:t.$vuetify.theme.dark,callback:function(e){t.$set(t.$vuetify.theme,"dark",e)},expression:"$vuetify.theme.dark"}})],1)],1)],1)],1),t.gotConfig?i("v-navigation-drawer",{attrs:{app:"",clipped:"","mini-variant":""},model:{value:t.sidebar,callback:function(e){t.sidebar=e},expression:"sidebar"}},[i("v-tabs",{attrs:{vertical:""},model:{value:t.tab_ix,callback:function(e){t.tab_ix=e},expression:"tab_ix"}},t._l(t.dash_tabs,(function(e){return i("v-tab",{key:e,staticClass:"px-0",staticStyle:{"min-width":"auto"}},[i("v-icon",{attrs:{large:""}},[t._v("mdi-"+t._s(t.tabs[e].icon))])],1)})),1)],1):t._e(),i("v-main",[t.gotConfig?i("v-tabs-items",{model:{value:t.tab_ix,callback:function(e){t.tab_ix=e},expression:"tab_ix"}},[i("div",{style:{backgroundColor:t.$vuetify.theme.themes[t.theme].background}},t._l(t.dash_tabs,(function(e,n){return i("v-tab-item",{key:e,class:{"is-active":n==t.tab_ix}},t._l(t.tabs[e].grids,(function(e){return i(t.grids[e].kind,{key:e,tag:"component",attrs:{id:e},on:{reconfig:function(e){return t.reconfig(e)}}})})),1)})),1)]):i("div",[t._v(" LOADING... ")])],1)],1)},c=[],u=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"mx-2"},[i("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on;return[i("v-btn",t._g({attrs:{small:"",icon:"",color:t.color}},Object.assign({},{click:t.handleClick},n)),[i("v-icon",[t._v("mdi-network")])],1)]}}])},[i("span",[t._v("Enable socket.io connection")])])],1)},l=[],d=i("e900"),f=i.n(d);window.uib_started=!1;var h={name:"Uib",data:function(){return{enabled:!1,connected:!1,msgCount:0}},computed:{color:function(){return this.enabled?this.connected?"green":"error":null}},created:function(){console.log("uib created")},deleted:function(){f.a.clearEventListeners(),console.log("uib deleted")},mounted:function(){this.enabled&&this.start()},methods:{start:function(){var t=this,e=f.a.get("ioConnected");console.log("uib mounted, uib_started=".concat(window.uib_started," Connected=").concat(e)),f.a.clearEventListeners();var i="/uib-flexdash";f.a.start({namespace:i,ioPath:"/uibuilder/vendor/socket.io",vueApp:null}),window.uib_started&&f.a.sendCtrl({from:"client",cacheControl:"REPLAY"}),window.uib_started=!0,f.a.onChange("msg",(function(e){t.msgCount++,this.enabled&&t.$emit("msg",e)})),f.a.onChange("ioConnected",(function(e){t.connected=!!e}))},send:function(t){f.a.send(t)},handleClick:function(){this.enabled=!this.enabled,window.uib_started||this.start()}}},p=h,g=i("2877"),v=i("6544"),b=i.n(v),m=i("8336"),_=i("132d"),y=i("3a2f"),w=Object(g["a"])(p,u,l,!1,null,null,null),k=w.exports;b()(w,{VBtn:m["a"],VIcon:_["a"],VTooltip:y["a"]});var C=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"mx-2"},[i("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on;return[i("v-btn",t._g({attrs:{small:"",icon:"",color:t.color}},Object.assign({},{click:t.handleChange},n)),[i("v-icon",[t._v("mdi-dice-multiple")])],1)]}}])},[i("span",[t._v("Enable random demo data to be fed into demo_*.")])])],1)},x=[],O=i("3835"),S=["kitchen","bedroom","study","living room","guest room"],D=function(){var t={};return function(e){var i=t[e]||[70,0,0,0],n=Object(O["a"])(i,4),o=n[0],a=n[1],r=n[2],s=n[3];function c(){var t;if(a)t=s*r;else{var e;do{e=2*Math.random()-1,s=2*Math.random()-1,r=e*e+s*s}while(r>=1);r=Math.sqrt(-2*Math.log(r)/r),t=e*r}return a^=1,t}var u,l=50,d=90;do{u=c()}while(o+u<l||o+u>d);return o+=u,t[e]=[o,a,r,s],o}}(),$={dash:{title:"FlexDash",tabs:["t00000","t00001"]},tabs:{t00000:{id:"t00000",icon:"view-dashboard",grids:["g0"]},t00001:{id:"t00001",icon:"home-thermometer",grids:["g1","g2"]}},grids:{g0:{id:"g0",kind:"fixed-grid",widgets:["0","3","2","9","6","7","8","10","11","12","13","14"]},g1:{id:"g1",kind:"fixed-grid",widgets:[]},g2:{id:"g2",kind:"fixed-grid",widgets:[]}},widgets:{0:{kind:"Stat",id:"0",static:{title:"Bedroom",value:"cold",unit:"F"},dynamic:{value:"bedroom"},rows:1,cols:1},2:{kind:"Stat",id:"2",static:{title:"Guest Room",unit:"F"},dynamic:{value:"guest room"},rows:1,cols:1},3:{kind:"Gauge",id:"3",static:{title:"Living Room",value:50,arc:270,center:!0,unit:"F",needle_color:"red",min:30},dynamic:{value:"living room"},rows:2,cols:2},6:{kind:"Gauge",id:"6",static:{title:"Kitchen",color:"lightblue",arc:90,unit:"F",min:0},dynamic:{value:"kitchen"},rows:1,cols:1},7:{kind:"Toggle",id:"7",static:{title:"light",off_value:"0",on_value:"ON",color:"secondary",value:"ON"},dynamic:{_output:"light",value:"light"},rows:1,cols:1},8:{kind:"PushButton",id:"8",static:{title:"launch",color:"secondary",output_value:"ON",icon:"rocket-launch",tooltip:"Next stop: Mars!"},dynamic:{_output:"light"},rows:1,cols:1},9:{kind:"PushButton",id:"9",static:{title:"",icon:"watering-can"},dynamic:{},rows:1,cols:1},10:{kind:"Gauge",id:"10",static:{title:"Kitchen",arc:180,base_color:"lightgreen",color:"blue",unit:"F",radius:90,needle_color:"white"},dynamic:{value:"kitchen"},rows:1,cols:1},11:{kind:"Sparkchart",id:"11",static:{title:"Livingrm",color:"green",line_width:4,fill:!0},dynamic:{value:"living room"},rows:1,cols:1},12:{kind:"Sparkchart",id:"12",static:{title:"Living Room",bars:!0},dynamic:{value:"living room"},rows:1,cols:1},13:{kind:"Sparkchart",id:"13",static:{title:"Kitchen"},dynamic:{value:"kitchen"},rows:1,cols:2},14:{kind:"TimePlot",id:"14",static:{title:"Temperatures"},dynamic:{data:"temp_data",options:"temp_opts"},rows:4,cols:4}}},j={series:[{label:"time"},{label:"Sensor 1",scale:"C",value:"v.toFixed(1) + '°C'"},{label:"Sensor 2",scale:"C",value:"v.toFixed(1) + '°C'"},{label:"Sensor 3",scale:"C",value:"v.toFixed(1) + '°C'"}],axes:[{},{scale:"F",values:'vv.map(v => v + "°F")'},{scale:"C",values:'vv.map(v => v + "°C")',side:1,grid:{show:!1}}],scales:{F:{from:"C",range:"[ min*9/5+32, max*9/5+32 ]"}}},T={name:"Demo",data:function(){return{enable:!0,timers:[]}},computed:{color:function(){return this.enable?"green":null}},mounted:function(){this.enable&&(this.enable=!1,this.handleChange(),window.setTimeout(this.tick,3e3))},methods:{handleChange:function(){var t=this;if(this.enable=!this.enable,console.log("Demo switch changed to",this.enable),this.enable){this.$emit("msg",{topic:"$config",payload:$});for(var e=function(e){t.timers.push(window.setInterval((function(){return t.tick(S[e])}),5e3+1e3*e)),t.tick(S[e])},i=0;i<S.length;i++)e(i);this.$emit("msg",{topic:"temp_opts",payload:j}),this.timers.push(window.setInterval(this.plot,3e3)),this.plot()}else this.timers.map((function(t){return window.clrInterval(t)})),this.timer=[]},tick:function(t){var e=Math.round(10*D(t))/10;this.$emit("msg",{topic:"".concat(t),payload:e})},plot:function(){var t=[Date.now()/1e3,Math.round(10*D("p1"))/10,Math.round(10*D("p2"))/10,Math.round(10*D("p3"))/10];this.$emit("msg",{topic:"temp_data",payload:t})}}},E=T,N=Object(g["a"])(E,C,x,!1,null,null,null),A=N.exports;b()(N,{VBtn:m["a"],VIcon:_["a"],VTooltip:y["a"]});var V={name:"Dash",components:{Uib:k,Demo:A},inject:["$config","$store"],data:function(){return{appTitle:"FlexDash",sidebar:!1,gotConfig:!1,tab_ix:null,tab_edit:!1,tab_icon:"",tab_grids:1,settings_menu:null,settings:{edit:"Edit mode",theme:"Toggle theme"}}},computed:{dash:function(){return this.gotConfig?this.$config.dash:{}},dash_tabs:function(){return this.dash.tabs||[]},tab_id:function(){return null!=this.tab_ix?this.dash_tabs[this.tab_ix]:null},tabs:function(){return this.gotConfig?this.$config.tabs:{}},grids:function(){return this.gotConfig?this.$config.grids:{}},theme:function(){return this.$vuetify.theme.dark?"dark":"light"},canUndo:function(){return this.$store.undo.buf.length>0},_sd:function(){return this.$store.sd},_config:function(){return this.$config}},watch:{tab_id:function(t){null!=t&&(this.tab_icon=this.tabs[t].icon,this.tab_grids=this.tabs[t].grids.length)},tabs:function(t){this.tab_ix>=t.length&&(this.tab_ix=t.length-1)}},provide:function(){var t=this;return{sendSrv:function(e,i){t.$refs.uib.send({topic:e,payload:i})}}},methods:{handleMsg:function(t){if("topic"in t&&"payload"in t)return"$config"!==t.topic||(console.log("*** config received"),this.gotConfig=!0,t.payload&&t.payload.dash)?void this.$store.insertData(t.topic,t.payload):(console.log("*** No or broken config, clearing! (got:",t.payload),void this.$store.initDash());console.log("Message w/out topic/payload:",t)},handleSave:function(){this.$store.updateTab(this.tab_id,{icon:this.tab_icon}),this.tab_edit=!1},handleCancel:function(){this.tab_edit=!1,this.tab_icon=this.tabs[this.tab_id].icon},handleAddTab:function(){var t=this;this.$store.addTab(),this.$nextTick((function(){t.tab_ix=t.dash_tabs.length-1,t.tab_edit=!0}))},handleDeleteTab:function(){this.$store.deleteTab(this.tab_ix),this.tab_ix>=this.$config.dash.tabs.length-1&&(this.tab_ix=this.$config.dash.tabs.length-1),this.tab_edit=!1}}},M=V,I=(i("6580"),i("7496")),P=i("40dc"),B=i("5bc1"),R=i("8860"),L=i("da13"),W=i("f6c4"),F=i("e449"),q=i("f774"),U=i("b73d"),G=i("71a3"),z=i("c671"),J=i("fe57"),K=i("aac8"),H=i("8654"),X=i("2a7f"),Y=Object(g["a"])(M,s,c,!1,null,null,null),Q=Y.exports;b()(Y,{VApp:I["a"],VAppBar:P["a"],VAppBarNavIcon:B["a"],VBtn:m["a"],VIcon:_["a"],VList:R["a"],VListItem:L["a"],VMain:W["a"],VMenu:F["a"],VNavigationDrawer:q["a"],VSwitch:U["a"],VTab:G["a"],VTabItem:z["a"],VTabs:J["a"],VTabsItems:K["a"],VTextField:H["a"],VToolbarTitle:X["a"],VTooltip:y["a"]});var Z=i("67b0"),tt=i("2909"),et=i("bee2"),it=i("53ca"),nt=i("b85c"),ot=i("d4ec"),at=i("99de"),rt=i("257e"),st=i("262e"),ct=i("2caf"),ut=i("9072"),lt=(i("b0c0"),i("9129"),i("a9e3"),i("4de4"),i("159b"),i("b64b"),i("0481"),i("a15b"),i("4fad"),function(t){Object(st["a"])(i,t);var e=Object(ct["a"])(i);function i(t){var n;return Object(ot["a"])(this,i),n=e.call(this,t),n.name="StoreError",Object(at["a"])(n,Object(rt["a"])(n))}return i}(Object(ut["a"])(Error)));function dt(t,e){var i,o=t,a=Object(nt["a"])(e);try{for(a.s();!(i=a.n()).done;){var r=i.value;if(""==r);else if(Array.isArray(o)){var s=parseInt(r,10);if(Number.isNaN(s))throw new lt("Array index '".concat(r,"' in '").concat(e,"' is not an int"));if(s<0||s>=o.length)throw new lt("Array index '".concat(r,"' in '").concat(e,"' > ").concat(o.length));o=o[s]}else{if("object"!==Object(it["a"])(o))throw new lt("Level '".concat(r,"' of '").concat(e,"'' is not traversable: ").concat(Object(it["a"])(o[r])));r in o&&"undefined"!==typeof o[r]||n["default"].set(o,r,{}),o=o[r]}}}catch(c){a.e(c)}finally{a.f()}return o}var ft=function(){function t(){return Object(ot["a"])(this,t),this.root=n["default"].observable({sd:{},$config:{dash:{},tabs:{},grids:{},widgets:{}}}),this.sd=this.root.sd,this.config=this.root.$config,this.queue=[],this.undo=n["default"].observable({buf:[],at:null}),this}return Object(et["a"])(t,[{key:"insertData",value:function(t,e){var i=this,o=t.split("/");if(o=o.filter((function(t){return t.length>0})),0==o.length)throw new lt("Cannot replace entire hierarchy");if("$config"===t)return Object.keys(e).forEach((function(t){n["default"].set(i.config,t,e[t])})),void console.log("Replaced $config with:",e);"$config"!==o[0]&&o.unshift("sd");var a=o.pop(),r=dt(this.root,o),s=void 0;if(Array.isArray(r)){var c=parseInt(a,10);if(Number.isNaN(c))throw new lt("Array index '".concat(a,"' is not a number"));if(c>=0&&c<r.length){if(void 0===e)throw new lt("Cannot delete array element '".concat(c,"' in '").concat(t,"'"));s=r[c],console.log("Updated array elt ".concat(t," with"),e),n["default"].set(r,c,e)}else{if(c!=r.length)throw new lt("Array index '".concat(c,"' in '").concat(t,"' > ").concat(r.length));if(void 0===e)throw new lt("Array index '".concat(c,"' in '").concat(t,"' >= ").concat(r.length));s=void 0,console.log("Appended array elt ".concat(t," with"),e),r.push(e)}}else{if("object"!==Object(it["a"])(r))throw new lt("".concat(t," is neither Array nor Object in server state"));s=r[a],void 0!==e?(console.log("Updated ".concat(t," with:"),e),n["default"].set(r,a,e)):(console.log("Deleted ".concat(t)),delete r[a])}return s}},{key:"pushUndo",value:function(t,e){var i=Date.now(),n=this.undo;if(n.at&&n.buf.length>0&&i-n.at<6e4&&t==n.buf[n.buf.length-1].tagline)console.log("undo coalesce"),n.buf[n.buf.length-1].mutation=[].concat(Object(tt["a"])(e),Object(tt["a"])(n.buf[n.buf.length-1].mutation));else{n.at=i,n.buf.push({tagline:t,mutation:e});while(n.buf.length>10)n.buf.shift()}}},{key:"performUndo",value:function(){console.log("perform undo");var t=this.undo;if(0==t.buf.length)throw new lt("undo buffer is empty");var e=t.buf.pop();t.at=null,this.qMutation(null,e.mutation)}},{key:"qMutation",value:function(t,e){console.log("queueing mutation",t);var i,n=[],o=Object(nt["a"])(e);try{for(o.s();!(i=o.n()).done;){var a=i.value;n.unshift([a[0],this.insertData("$config/"+a[0],a[1])])}}catch(r){o.e(r)}finally{o.f()}t&&this.pushUndo(t,n)}},{key:"genId",value:function(t,e){var i=null;while(!i||i in t)i="00000"+Math.floor(1e4*Math.random()),i=e+i.substring(i.length-5);return i}},{key:"tabByID",value:function(t){var e=this.config.tabs[t];if(e&&e.id==t)return e;throw new lt("tab ".concat(t," does not exist"))}},{key:"gridByID",value:function(t){var e=this.config.grids[t];if(e&&e.id==t)return e;throw new lt("grid ".concat(t," does not exist"))}},{key:"widgetByID",value:function(t){var e=this.config.widgets[t];if(e&&e.id==t)return e;throw new lt("widget ".concat(t," does not exist"))}},{key:"tabIDByIX",value:function(t){var e=this.config.dash.tabs;if(e&&t>=0&&t<e.length)return e[t];throw new lt("tab #".concat(t," does not exist"))}},{key:"gridIDByIX",value:function(t,e){if("string"===typeof t&&(t=this.tabByID(t)),t&&e>=0&&e<t.grids.length)return t.grids[e];throw new lt("grid #".concat(e," does not exist in tab ").concat(t.id))}},{key:"widgetIDByIX",value:function(t,e){if("string"===typeof t&&(t=this.gridByID(t)),t&&e>=0&&e<t.widgets.length)return t.widgets[e];throw new lt("widget #".concat(e," does not exist in grid ").concat(t.id))}},{key:"initDash",value:function(){if(this.config.dash.title)throw new lt("cannot init a non-empty store");this.insertData("$config/widgets",{}),this.insertData("$config/grids",{g00001:{id:"g00001",kind:"fixed-grid",widgets:[]}}),this.insertData("$config/tabs",{t00001:{id:"t00001",icon:"view-dashboard",grids:["g00001"]}}),this.insertData("$config/dash",{title:"FlexDash",tabs:["t00001"]})}},{key:"addTab",value:function(){var t=this.genId(this.config.tabs,"t"),e=this.genId(this.config.grids,"g"),i=this.config.dash.tabs.length;return this.qMutation("add a tab",[["grids/".concat(e),{id:e,kind:"fixed-grid",widgets:[]}],["tabs/".concat(t),{id:t,icon:"rocket-launch",grids:[e]}],["dash/tabs/".concat(i),t]]),i}},{key:"deleteTab",value:function(t){var e=this,i=this.tabIDByIX(t),n=this.tabByID(i).grids,o=n.map((function(t){return e.config.grids[t].widgets})).flat();this.qMutation("delete a tab",[["dash/tabs",this.config.dash.tabs.filter((function(e,i){return i!=t}))],["tabs/".concat(i),void 0]].concat(Object(tt["a"])(n.map((function(t){return["grids/".concat(t),void 0]}))),Object(tt["a"])(o.map((function(t){return["widgets/".concat(t),void 0]})))))}},{key:"updateTab",value:function(t,e){this.tabByID(t),this.qMutation("update tab ".concat(Object.keys(e).join(",")),Object.entries(e).map((function(e){var i=Object(O["a"])(e,2),n=i[0],o=i[1];return["tabs/".concat(t,"/").concat(n),o]})))}},{key:"addGrid",value:function(t){var e=this.tabByID(t),i=this.genId(this.config.grids,"g"),n=e.grids.length;return this.qMutation("add a grid",[["grids/".concat(i),{id:i,kind:"fixed-grid",widgets:[]}],["tabs/".concat(t,"/grids/").concat(n),i]]),n}},{key:"deleteGrid",value:function(t,e){var i=this.tabByID(t),n=this.gridIDByIX(i,e),o=this.gridByID(n);this.qMutation("delete a grid",[["tabs/".concat(t,"/grids"),i.grids.filter((function(t,i){return i!=e}))],["grids/".concat(n),void 0]].concat(Object(tt["a"])(o.widgets.map((function(t){return["widgets/".concat(t),void 0]})))))}},{key:"updateGrid",value:function(t,e){this.gridByID(t),this.qMutation("update grid ".concat(Object.keys(e).join(",")),Object.entries(e).map((function(e){var i=Object(O["a"])(e,2),n=i[0],o=i[1];return["grids/".concat(t,"/").concat(n),o]})))}},{key:"addWidget",value:function(t,e){var i=this.gridByID(t),n=this.genId(this.config.widgets,"w"),o=i.widgets.length;return this.qMutation("add a widget",[["widgets/".concat(n),{id:n,rows:1,cols:1,kind:e,static:{title:e},dynamic:{}}],["grids/".concat(t,"/widgets/").concat(o),n]]),o}},{key:"deleteWidget",value:function(t,e){var i=this.gridByID(t),n=this.widgetIDByIX(i,e);this.qMutation("delete a widget",[["grids/".concat(t,"/widgets"),i.widgets.filter((function(t,i){return i!=e}))],["widgets/".concat(n),void 0]])}},{key:"updateWidget",value:function(t,e){this.widgetByID(t),this.qMutation("update widget ".concat(Object.keys(e).join(",")),Object.entries(e).map((function(e){var i=Object(O["a"])(e,2),n=i[0],o=i[1];return["widgets/".concat(t,"/").concat(n),o]})))}},{key:"updateWidgetProp",value:function(t,e,i,n){this.widgetByID(t),this.qMutation("update widget prop ".concat(e,":").concat(i),[["widgets/".concat(t,"/").concat(e,"/").concat(i),n]])}}]),t}(),ht=new ft,pt=ht;function gt(t){return Object.fromEntries(t.keys().map((function(e){var i=t(e),o=e.split("/").pop().replace(/\.\w+$/,""),a=o.replace(/-\w/g,(function(t){return t[1].toLocaleUpperCase()}));return a=a[0].toLocaleUpperCase()+a.substr(1),n["default"].component(a,i.default||i),console.log("Imported ".concat(a," globally from ").concat(e)),[a,i.default]})))}window.io=i("8055"),n["default"].config.productionTip=!1,n["default"].use(Z["a"]),n["default"].loadScript("./date_helpers.js");var vt=i("5a91");window.widgetPalette=gt(vt);var bt=i("ac25");window.gridPalette=gt(bt),new n["default"]({vuetify:r,data:{editMode:!0},provide:{$config:pt.config,$store:pt},render:function(t){return t(Q)}}).$mount("#app")},"58a3":function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"gauge-card d-flex"},[i("svg-gauge",t._b({style:t.gauge_valign,attrs:{value:t.value}},"svg-gauge",t.$props,!1)),i("div",{staticClass:"gauge-card--label d-flex flex-column mx-auto",class:t.txt_valign},[i("v-card-text",{staticClass:"gauge-value d-flex pa-0 width100"},[i("span",{staticClass:"mx-auto"},[t._v(t._s(t.valTxt)),i("span",{staticClass:"unit"},[t._v(t._s(t.unitTxt))])])]),t.title?i("v-card-text",{staticClass:"gauge-title d-flex pa-0"},[i("span",{staticClass:"mx-auto"},[t._v(t._s(t.title))])]):t._e()],1)],1)},o=[],a=(i("a9e3"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("svg",{staticClass:"gauge",attrs:{viewBox:t.vbox,preserveAspectRatio:t.ar}},[i("circle",{staticClass:"gauge-base",attrs:{cx:"0",cy:"0",fill:"transparent",r:t.stroke_radius,stroke:t.base_color,"stroke-width":t.stroke_width,transform:t.xform,"stroke-dasharray":t.stroke_bdash}}),i("circle",{staticClass:"gauge-stroke",attrs:{cx:"0",cy:"0",fill:"transparent",r:t.stroke_radius,stroke:t.color,"stroke-width":t.stroke_width,transform:t.xform,"stroke-dasharray":t.stroke_sdash}}),i("line",{staticClass:"gauge-needle",attrs:{x1:t.needle_start,y1:0,x2:100,y2:0,stroke:t.needle_color,"stroke-width":"2",transform:t.nform}})])}),r=[],s=(i("99af"),{name:"SvgGauge",props:{min:{type:Number,default:0},max:{type:Number,default:100},value:{type:Number,default:30},color:{type:String,default:"--v-purple-base"},base_color:{type:String,default:"lightgrey"},needle_color:{type:String,default:"white"},radius:{type:Number,default:70},arc:{type:Number,default:270},stretch:{type:Boolean,default:!1}},computed:{frac:function(){var t=(this.value-this.min)/(this.max-this.min);return Math.min(1,Math.max(0,t))},stroke_width:function(){return 100-this.radius},stroke_radius:function(){return 100-this.stroke_width/2},needle_start:function(){return 100-1.25*this.stroke_width},circumference:function(){return 2*this.stroke_radius*Math.PI},stroke_bdash:function(){var t=this.arc*this.circumference/360;return"".concat(t," ").concat(this.circumference)},stroke_sdash:function(){var t=this.arc*this.frac*this.circumference/360;return"".concat(t," ").concat(this.circumference)},xform:function(){return"rotate(".concat(270-this.arc/2,", 0, 0)")},nform:function(){return"rotate(".concat(270-this.arc/2+this.arc*this.frac,", 0, 0)")},ar:function(){return this.stretch?"none":"xMidYMid"},vbox:function(){var t=this.arc>=180?100:this.needle_start,e=(this.arc-180)/2*Math.PI/180,i=100+t*Math.sin(e),n=this.arc>=180?200:200*Math.cos(e);return"-".concat(n/2," -100 ").concat(n," ").concat(i)}}}),c=s,u=i("2877"),l=Object(u["a"])(c,a,r,!1,null,null,null),d=l.exports,f={name:"Gauge",components:{SvgGauge:d},props:{value:{type:Number,default:null},unit:{type:String,default:""},title:{type:String,default:"Gauge"},arc:{type:Number,default:90,validator:function(t){return t>10&&t<=360}},center:{type:Boolean,default:!1},min:{type:Number,default:0},max:{type:Number,default:100},color:{type:String,default:"green"},base_color:{type:String,default:"lightgrey"},needle_color:{type:String,default:"white"},radius:{type:Number,default:70},stretch:{type:Boolean,default:!1}},computed:{txt_valign:function(){var t=null!==this.center?this.center:!(this.arc<200);return t?"my-auto":"mt-auto"},gauge_valign:function(){return this.arc<180?"height:auto;":""},unitTxt:function(){return"--"===this.value?"":this.unit},valTxt:function(){return"number"==typeof this.value?Math.round(10*this.value)/10:null===this.value?"--":this.value}}},h=f,p=(i("ce88"),i("6544")),g=i.n(p),v=i("99d9"),b=Object(u["a"])(h,n,o,!1,null,"d0e2edf8",null);e["default"]=b.exports;g()(b,{VCardText:v["a"]})},"5a91":function(t,e,i){var n={"./gauge.vue":"58a3","./push-button.vue":"63e2","./sparkchart.vue":"1ec4","./stat.vue":"254b","./time-plot.vue":"6bc8","./toggle.vue":"a9ef"};function o(t){var e=a(t);return i(e)}function a(t){if(!i.o(n,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return n[t]}o.keys=function(){return Object.keys(n)},o.resolve=a,t.exports=o,o.id="5a91"},"5cc2":function(t,e){t.exports={name:"PushButton",props:{enabled:{default:!0},color:{default:"primary"},output_value:{default:25},icon:{default:null},title:{default:"Button"},tooltip:{default:null}},computed:{bindings:function(){return{disabled:!this.enabled,color:this.color}}},methods:{clickEv:function(t){console.log("PushButton event:",t),this.$emit("send",this.output_value)}}}},"63e2":function(t,e,i){"use strict";i.r(e);var n=i("dc81"),o=i("829b");for(var a in o)["default"].indexOf(a)<0&&function(t){i.d(e,t,(function(){return o[t]}))}(a);i("34fc");var r=i("2877"),s=i("6544"),c=i.n(s),u=i("8336"),l=i("132d"),d=i("3a2f"),f=Object(r["a"])(o["default"],n["a"],n["b"],!1,null,"68ce9d17",null);e["default"]=f.exports,c()(f,{VBtn:u["a"],VIcon:l["a"],VTooltip:d["a"]})},6505:function(t,e,i){},6580:function(t,e,i){"use strict";i("467f")},"6bc8":function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},o=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"px-1"},[i("div",{staticStyle:{"xx-background-color":"#eef"}})])}],a=(i("99af"),i("d81d"),i("159b"),i("cb29"),i("d3b7"),i("ddb0"),i("07ac"),i("ab54")),r=(i("fa7e"),["#e6194b","#3cb44b","#ffe119","#4363d8","#f58231","#911eb4","#46f0f0","#f032e6","#bcf60c","#fabebe","#008080","#e6beff","#9a6324","#fffac8","#800000","#aaffc3","#808000","#ffd8b1","#000075","#808080","#ffffff","#000000"]),s={name:"TimePlot",props:{options:{type:Object,default:function(){return null}},data:{type:Array,default:function(){},validator:function(t){return Array.isArray(t)&&t.length}}},data:function(){return{chart:null,ro:null,width:40,chart_data:null,dark_watcher:null}},watch:{options:function(){console.log("Time-plot options changed"),this._destroy(),this._create()},data:function(t){if(t){var e=Array.isArray(t[0]);if(this.chart&&this.chart_data&&!e){for(var i=this.chart_data.length,n=0;n<i;n++)this.chart_data[n].push(t[n]);var o=Math.max(this.width/2,20);while(this.chart_data[0].length>o)for(var a=0;a<i;a++)this.chart_data[a].shift();this.chart.setData(this.chart_data)}else this.chart&&this._destroy(),this.chart_data=this._transpose(e?t:[t]),this._create()}}},mounted:function(){var t=this;this._create(),this.ro=new ResizeObserver(this._onResize).observe(this.$el);var e=this;this.dark_watcher=this.$watch((function(){return e.$vuetify.theme.dark}),(function(){t._destroy(),t._create()}))},beforeDestroy:function(){console.log("BeforeDestroy uPlot"),this.ro&&this.ro.unobserve(this.$el),this.ro=null,this._destroy(),this.dark_watcher()},methods:{_destroy:function(){this.chart&&(console.log("Destroying uPlot"),this.chart.destroy(),this.chart=null)},_calcSize:function(){var t=this.options.width||this.$el.children[0].clientWidth,e=this.options.height||t/(this.options.aspect||2);return console.log("Time-plot container sized to ".concat(t,"x").concat(e)),this.width=t,{width:t,height:e}},_onResize:function(){this.chart&&this.chart.setSize(this._calcSize())},_transpose:function(t){if(!t||0==t.length)return[];t[0].map;var e=t[0].map((function(){return Array(t.length)}));return t.forEach((function(t,i){t.forEach((function(t,n){e[n][i]=t}))})),e},_create:function(){var t=this;if(console.log("Creating uPlot"),this.chart_data&&0!==this.chart_data.length){var e=JSON.parse(JSON.stringify(this.options));Object.assign(e,this._calcSize()),e.series||(e.series=[]);while(e.series.length<this.chart_data.length)e.series.push({});e.series.forEach((function(e,i){e.label||(e.label=i?"series "+i:"time"),i&&(e.stroke||(e.stroke=r[(i-1)%20]),e.width||(e.width=2),"string"===typeof e.value&&(e.value=new Function("u","v",'"use strict";return ('.concat(e.value,")")))),t.$vuetify.theme.dark&&(e.points||(e.points={}),e.points.fill||(e.points.fill="#1e1e1e"))})),(!e.axes||e.axes.length<2)&&(e.axes=[{},{}]),e.axes.forEach((function(e){e.values&&"string"===typeof e.values&&(e.values=new Function("u","vv","s",'"use strict";return ('.concat(e.values,")"))),t.$vuetify.theme.dark&&(e.grid||(e.grid={}),e.grid.stroke||(e.grid.stroke="#444"),e.stroke||(e.stroke="#ccc"))})),Object.values(e.scales||{}).forEach((function(t){t.range&&"string"===typeof t.range&&(t.range=new Function("u","min","max",'"use strict";return ('.concat(t.range,")")))})),console.log("uPlot options:",e),this.chart=new a["a"](e,this.chart_data,this.$el.children[0])}}}},c=s,u=(i("fe07"),i("2877")),l=Object(u["a"])(c,n,o,!1,null,null,null);e["default"]=l.exports},7408:function(t,e,i){},7658:function(t,e,i){},"78fb":function(t,e,i){"use strict";i("6505")},"829b":function(t,e,i){"use strict";i.r(e);var n=i("5cc2"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(a);e["default"]=o.a},8896:function(t,e,i){},"9d9d":function(t,e,i){"use strict";i.r(e);var n=i("26df"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(a);e["default"]=o.a},a9ef:function(t,e,i){"use strict";i.r(e);var n=i("3eb2"),o=i("07c0");for(var a in o)["default"].indexOf(a)<0&&function(t){i.d(e,t,(function(){return o[t]}))}(a);var r=i("2877"),s=i("6544"),c=i.n(s),u=i("b73d"),l=Object(r["a"])(o["default"],n["a"],n["b"],!1,null,null,null);e["default"]=l.exports,c()(l,{VSwitch:u["a"]})},ac25:function(t,e,i){var n={"./fixed-grid.vue":"322f"};function o(t){var e=a(t);return i(e)}function a(t){if(!i.o(n,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return n[t]}o.keys=function(){return Object.keys(n)},o.resolve=a,t.exports=o,o.id="ac25"},b329:function(t,e,i){},bf03:function(t,e,i){i("a9e3"),i("cb29"),t.exports={name:"Sparkchart",props:{value:{default:0},color:{type:String,default:"blue"},fill:{type:Boolean,default:!1},line_width:{type:Number,default:4},bars:{type:Boolean,default:!1}},data:function(){return{data:[],ro:null,height:10,width:20}},computed:{bindings:function(){return{color:this.color,fill:this.fill,lineWidth:this.line_width,padding:this.line_width,value:this.data,type:this.bars?"bar":"trend",autoLineWidth:!!this.bars,height:this.height,width:this.width}}},mounted:function(){var t=this;this.$nextTick((function(){t.$el.offsetParent?t.ro=new ResizeObserver(t._onResize).observe(t.$el.offsetParent):console.log("sparkshart oops1")}))},beforeUnmount:function(){this.ro&&this.ro.unobserve(this.$el.offsetParent)},watch:{value:function(t){if("number"===typeof t||null===t){this.data.push(t);while(this.data.length>20)this.data.shift()}else Array.isArray(t)&&(this.data=t)}},methods:{_onResize:function(){this.$el.offsetParent?(this.height=this.$el.offsetParent.clientHeight-this.$el.offsetTop,this.width=this.$el.offsetParent.clientWidth,console.log("_onResize",this.color,"Height:",this.height)):console.log("sparkchart oops2")}}}},ce88:function(t,e,i){"use strict";i("db21")},d0ef:function(t,e,i){"use strict";i("7408")},d473:function(t,e,i){},d9ba:function(t,e,i){"use strict";i.d(e,"a",(function(){return n})),i.d(e,"b",(function(){return o}));var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticStyle:{width:"100%"}},[i("v-sparkline",t._b({ref:"sparkl"},"v-sparkline",t.bindings,!1))],1)},o=[]},db21:function(t,e,i){},db64:function(t,e,i){"use strict";i("d473")},dc81:function(t,e,i){"use strict";i.d(e,"a",(function(){return n})),i.d(e,"b",(function(){return o}));var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"pushbutton d-flex"},[i("v-tooltip",{attrs:{top:"","open-on-hover":!!t.tooltip},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,o=e.attrs;return[i("v-btn",t._g(t._b({staticClass:"ma-auto",attrs:{large:"",dense:"","max-width":"95%"},on:{click:function(e){return t.clickEv(e)}}},"v-btn",Object.assign(t.bindings,o),!1),n),[t.icon?i("v-icon",{attrs:{large:!t.title}},[t._v("mdi-"+t._s(t.icon))]):t._e(),t._v(" "),i("span",[t._v(t._s(t.title))])],1)]}}])},[t.tooltip?i("span",[t._v(t._s(t.tooltip))]):t._e()])],1)},o=[]},e900:function(t,e,i){"use strict";var n=i("7037").default;if(i("8a79"),i("fb6a"),i("ac1f"),i("5319"),i("466d"),i("4de4"),i("1276"),i("498a"),i("a15b"),i("b0c0"),i("159b"),i("b64b"),i("99af"),i("d81d"),"undefined"===typeof o)var o=i("8055");(function(){var i=this,a=i.uibuilder,r=function(){String.prototype.endsWith||(String.prototype.endsWith=function(t){return-1!==this.indexOf(t,this.length-t.length)});var t=this;t.version="3.3.0",t.debug=!1,t.moduleName="uibuilder",t.isUnminified=/param/.test((function(t){})),t.dummyAuth={id:null,jwt:void 0,sessionExpiry:void 0,userValidated:!1,info:{error:void 0,message:void 0,validJwt:void 0}},t._auth=void 0,t.started=!1,t.uiDebug=function(){if(t.debug){var e=arguments[0];console[e].apply(console,[].slice.call(arguments,1))}},t.me=function(){return!0===t.debug?t:"uibuilderfe.js Version: "+t.version},t.uiDebug("log","\nuibuilderfe: Debug? ",t.debug,"\n\t\tVersion? ",t.version,"\n\t\tRunning Packed version? ",!t.isUnminified,"\n "),t.setIOnamespace=function(){var e="";try{e=document.cookie.match(/uibuilder-namespace\s*=.*?\s*;/g)[0].replace("uibuilder-namespace=","").replace(";","")}catch(n){}if(""===e){var i=window.location.pathname.split("/").filter((function(t){return""!==t.trim()}));i.length>0&&i[i.length-1].endsWith(".html")&&i.pop(),e=i.pop(),t.uiDebug("log","uibuilderfe: IO Namespace - Found via url path: "+e)}else t.uiDebug("log","uibuilderfe: IO Namespace - Found via cookie: "+e);return e="/"+e,t.uiDebug("log","uibuilderfe: IO Namespace: "+e),e},t.autoSendReady=!0,t.allowScript=!0,t.allowStyle=!0,t.removeScript=!0,t.removeStyle=!0,t.msg={},t.ctrlMsg={},t.sentMsg={},t.sentCtrlMsg={},t.msgsSent=0,t.msgsReceived=0,t.msgsSentCtrl=0,t.msgsCtrl=0,t.ioConnected=!1,t.serverTimeOffset=null,t.isAuthorised=!1,t.authTokenExpiry=null,t.authData={},t.ioChannels={control:"uiBuilderControl",client:"uiBuilderClient",server:"uiBuilder"},t.retryMs=2e3,t.retryFactor=1.5,t.timerid=null,t.ioNamespace=t.setIOnamespace(),t.ioTransport=["polling","websocket"],t.loaded=!1,t.authToken="";var e=window.location.pathname.split("/").filter((function(t){return""!==t.trim()}));return e.length>0&&e[e.length-1].endsWith(".html")&&e.pop(),t.url=e.pop(),t.httpNodeRoot="/"+e.join("/"),t.ioPath=c(t.httpNodeRoot,t.moduleName,"vendor","socket.io"),t.uiDebug("debug","uibuilderfe: ioPath: "+t.ioPath+", httpNodeRoot: "+t.httpNodeRoot+", uibuilder url (not used): "+t.url),t.set=function(e,i){t[e]=i,t.uiDebug("debug","uibuilderfe: prop set - prop: "+e+", val: "+("object"===n(i)?JSON.stringify(i):i)),t.emit(e,i)},t.checkConnect=function(e,i){var n=n++||1;t.uiDebug("debug","uibuilderfe:checkConnect. Reconnect - Depth: "+n+", Delay: "+e+", Factor: "+i,t.ioNamespace,t.ioPath),t.timerid&&window.clearTimeout(t.timerid),t.timerid=window.setTimeout((function(){t.uiDebug("debug","uibuilderfe:checkConnect timeout. SIO reconnect attempt, timeout: "+e+", depth: "+n,t.ioNamespace,t.ioPath),console.info("[uibuilderfe:checkConnect:setTimeout] Socket.IO reconnection attempt. Current delay: "+e),t.socket.close(),t.socket.connect(),t.timerid=null,t.checkConnect(e*i,i)}),e)},t.checkTimestamp=function(e){if(e.hasOwnProperty("serverTimestamp")){var i=new Date(e.serverTimestamp),n=Math.round((new Date-i)/36e5);n!==t.serverTimeOffset&&(t.set("serverTimeOffset",n),t.uiDebug("log","uibuilderfe:"+t.ioChannels.server+" (server): Offset changed to: "+n))}},t.ioSetup=function(){t.uiDebug("debug","uibuilderfe:ioSetup: About to create IO. Namespace: "+t.ioNamespace+", Path: "+t.ioPath+", Transport: ["+t.ioTransport.join(", ")+"]"),t.socketOptions={path:t.ioPath,transports:t.ioTransport,transportOptions:{polling:{extraHeaders:{"x-clientid":"uibuilderfe"}}}},t.socket=o(t.ioNamespace,t.socketOptions),t.socket.on("connect",(function(){t.uiDebug("info","uibuilderfe:ioSetup: SOCKET CONNECTED - Namespace: "+t.ioNamespace," Server Channel: ",t.ioChannels.server," Control Channel: ",t.ioChannels.control),t.set("ioConnected",!0),t.timerid&&(window.clearTimeout(t.timerid),t.timerid=null)})),t.socket.on(t.ioChannels.server,(function(e){t.uiDebug("debug","uibuilderfe:ioSetup:"+t.ioChannels.server+" (server): msg received - Namespace: "+t.ioNamespace,e),e=s(e,"payload"),t.checkTimestamp(e),e._auth&&t.updateAuth(e._auth),t.allowScript&&e.hasOwnProperty("script")&&(t.newScript(e.script),t.removeScript&&delete e.script),t.allowStyle&&e.hasOwnProperty("style")&&(t.newStyle(e.style),t.removeStyle&&delete e.style),t.set("msg",e),t.set("msgsReceived",t.msgsReceived+1)})),t.socket.on(t.ioChannels.control,(function(e){if(t.uiDebug("debug","uibuilder:ioSetup:"+t.ioChannels.control+" (control): msg received - Namespace: "+t.ioNamespace,e),null===e)e={};else if("object"!==n(e)){var i={};i["uibuilderCtrl:"+t.ioChannels.control]=e,e=i}switch(e.hasOwnProperty("debug")&&(t.debug=e.debug),t.checkTimestamp(e),t.set("ctrlMsg",e),t.set("msgsCtrl",t.msgsCtrl+1),e.uibuilderCtrl){case"ready for content":e._auth&&t.updateAuth(e._auth),t.uiDebug("debug","uibuilderfe:ioSetup:"+t.ioChannels.control+' Received "ready for content" from server');break;case"shutdown":t.uiDebug("debug","uibuilderfe:ioSetup:"+t.ioChannels.control+' Received "shutdown" from server'),t.set("serverShutdown",void 0);break;case"client connect":e._auth&&t.updateAuth(e._auth),!0===t.autoSendReady&&(t.uiDebug("debug","uibuilderfe:ioSetup:"+t.ioChannels.control+' Received "client connect" from server, auto-sending REPLAY control msg'),t.send({uibuilderCtrl:"ready for content",cacheControl:"REPLAY"},t.ioChannels.control));break;case"authorised":t.uiDebug("debug","uibuilderfe:ioSetup:"+t.ioChannels.control+' Received "authorised" from server'),e._auth?t.updateAuth(e._auth):(t.uiDebug("debug","uibuilderfe:ioSetup:"+t.ioChannels.control+' Received "authorised" from server but without a _auth property - logon failed'),t.markLoggedOut("Logon succeeded but no _auth received, logged out"));break;case"authorisation failure":t.uiDebug("debug","uibuilderfe:ioSetup:"+t.ioChannels.control+' Received "authorisation failure" from server'),t.markLoggedOut("Logon authorisation failure",e._auth.authData);break;case"logged off":t.uiDebug("debug","uibuilderfe:ioSetup:"+t.ioChannels.control+' Received "logged off" from server'),t.markLoggedOut("Logged off by logout() request",e._auth);break;default:t.uiDebug("debug","uibuilderfe:ioSetup:"+t.ioChannels.control+' Received "'+e.uibuilderCtrl+'" from server'),e._auth&&t.updateAuth(e._auth)}})),t.socket.on("disconnect",(function(e){t.uiDebug("info","uibuilderfe:ioSetup: SOCKET DISCONNECTED - Namespace: "+t.ioNamespace+", Reason: "+e),t.set("ioConnected",!1),console.warn("[uibuilderfe:socket-disconnect] Reason: "+e),t.checkConnect(t.retryMs,t.retryFactor)})),t.socket.on("connect_error",(function(e){t.uiDebug("error","uibuilderfe:ioSetup: SOCKET CONNECT ERROR - Namespace: "+t.ioNamespace+" ioPath: "+t.ioPath+", Reason: "+e.message)})),t.socket.on("error",(function(e){t.uiDebug("warn","uibuilderfe:ioSetup: SOCKET ERROR from server - MESSAGE: ",e),t.set("socketError",e)})),t.checkConnect(t.retryMs,t.retryFactor)},t.markLoggedOut=function(e,i){void 0===t._auth&&void 0===i||(i=t.dummyAuth,void 0!==e&&(t._auth.info.message=e),t.set("isAuthorised",!1),t.set("_auth",i))},t.logon=function(e,i){void 0===t._auth&&void 0===e||(void 0===e&&(e=t._auth),void 0!==e.id&&null!==e.id&&0!==e.id.length?(e.info||(e.info=t.dummyAuth.info),t.set("_auth",e),i||t.send({uibuilderCtrl:"logon",from:"client",_auth:t._auth},t.ioChannels.control),t.uiDebug("log","[uibuilder:logon] ",t._auth)):console.error("[uibuilder:logon] No logon id supplied, ignoring request."))},t.logoff=function(e,i){void 0===t._auth&&void 0===e||(void 0===e&&(e=t._auth),void 0!==e.id&&null!==e.id&&0!==e.id.length?(e.info||(e.info=t.dummyAuth.info),t._auth=e,i||t.send({uibuilderCtrl:"logoff",from:"client",_auth:t._auth},t.ioChannels.control)):console.error("[uibuilder:logoff] No logoff id supplied, ignoring request."))},t.updateAuth=function(e){if(void 0!==t._auth||void 0!==e){if(void 0===e&&(e=t._auth),void 0===e.id||null===e.id||0===e.id.length)return console.error("[uibuilder:updateAuth] No auth id supplied by server, ignoring server response."),void(e.info&&e.info.error&&console.warn("[uibuilder:updateAuth] Error from Server: ",e.info.error));e.info||(e.info=t.dummyAuth.info),e.userValidated&&e.jwt&&!0===e.info.validJwt&&new Date(e.sessionExpiry)>new Date?(t.set("isAuthorised",!0),t.set("_auth",e)):t.markLoggedOut("Logon succeeded but no token received, logged out")}},t.sendAuth=function(){try{if(void 0===t._auth)return;return t.isAuthorised?(new Date(t._auth.sessionExpiry)>new Date||t.markLoggedOut("Automatically logged off. Token expired"),t._auth):t._auth}catch(e){return}},t.send=function(e,i){null!==i&&void 0!==i||(i=t.ioChannels.client),t.uiDebug("log","uibuilderfe: sending msg - Namespace: "+t.ioNamespace+", Channel: "+i,e),i===t.ioChannels.client?e=s(e,"payload"):i===t.ioChannels.control&&(e=s(e,"uibuilderCtrl"),e.hasOwnProperty("uibuilderCtrl")||(e.uibuilderCtrl="manual send"),e.from="client"),e._socketId=t.socket.id,e._auth=t.sendAuth(),i===t.ioChannels.client?(t.set("sentMsg",e),t.set("msgsSent",t.msgsSent+1)):i===t.ioChannels.control&&(t.set("sentCtrlMsg",e),t.set("msgsSentCtrl",t.msgsSentCtrl+1)),t.socket.emit(i,e)},t.onChange=function(e,i){t.events[e]?t.events[e].push(i):t.events[e]=[i]},t.clearEventListeners=function(){t.events=[]},t.events={},t.emit=function(e){var i=t.events[e];if(i)for(var n=Array.prototype.slice.call(arguments,1),o=0;o<i.length;o++)i[o].apply(t,n)},t.newScript=function(e){if(!0===t.allowScript&&""!==e&&"undefined"!==typeof e){t.uiDebug("log","uibuilderfe: newCode - script: "+e);var i=document.createElement("script");i.type="text/javascript",i.defer=!0,i.textContent=e,document.getElementsByTagName("body")[0].appendChild(i)}},t.newStyle=function(e){if(!0===t.allowStyle&&""!==e&&"undefined"!==typeof e){t.uiDebug("log","uibuilderfe: newStyle - style: "+e);var i=document.createElement("style");i.textContent=e,document.getElementsByTagName("head")[0].appendChild(i)}},t.showToast=function(e){if(t.vueApp)if(t.vueApp.$bvToast)if(e._uib&&null!==e._uib&&"Object"===e._uib.constructor.name){var i=t.vueApp.$createElement,n={};e._uib.options&&(n=Object.assign({},e._uib.options));var o="";e.payload&&(o+=e.payload),n.content&&(o+=n.content);var a=i("p",{domProps:{innerHTML:o}});n.title&&(n.title=i("p",{domProps:{innerHTML:n.title}})),n.append&&(n.appendToast=n.append),n.autoHideDelay&&(n.autohide=!0,n.delay=n.autoHideDelay),""!==o?t.vueApp.$bvToast.toast(a,n):console.warn("[uibuilder:toast] Toast content is blank. Not shown.")}else console.warn("[uibuilder:toast] Incoming msg requires msg._uib object, cannot create a toast");else console.warn("[uibuilder:toast] bootstrap-vue toast component not available, cannot create a toast");else console.warn("[uibuilder:toast] Vue app object not available, cannot create a toast")},t.showAlert=function(){},t.showComponentDetails=function(e){if(t.vueApp&&t.vueApp.$refs[e]){var i=t.vueApp.$refs[e],n={};if(i.$options)n={uibuilderCtrl:"vue component details",componentDetails:{ref:e,tag:i.$options._componentTag,props:i.$options._propKeys}};else{var o='[uibuilderfe:showComponentDetails] ref="'.concat(e,'" is not a Vue Component. Details cannot be returned.');t.uiDebug("warn",o),n={uibuilderCtrl:"vue component details",componentDetails:{warning:o,ref:e,tag:null,props:null}}}return n}},t.onChange("msg",(function(e){if(t.vueApp&&e._uib&&(!0===e._uib.reload&&(console.log("reloading"),location.reload()),e._uib.componentRef)){var i=t.vueApp,n=e._uib.componentRef;if(e._uib.requestDetails){var o=t.showComponentDetails(n);o&&(e.topic&&(o.topic=e.topic),t.send(o,t.ioChannels.control))}else if("globalNotification"!==n)if("globalAlert"!==n)if(n in i.$refs){if(e._uib.options&&(t.uiDebug("log","🔢📈 new component instance options received for ref",n,":",e._uib.options),Object.keys(e._uib.options).forEach((function(o){try{i.$set(i.$refs[n],o,e._uib.options[o])}catch(a){t.uiDebug("warn",'[uibuilderfe:internal:onChange] Could not update prop "'.concat(o,'" for component ref="').concat(n,'". Error: ').concat(a.message))}}))),e.payload){t.uiDebug("log","🔢📈 new component instance value received for ref",n,":",e.payload);try{i.$refs[n].$props["config"]["value"]=e.payload}catch(s){}}}else{var a='[uibuilderfe:internal:onChange] ref="'.concat(n,'" is not a Vue Component. Cannot set props.');t.uiDebug("warn",a);var r={uibuilderCtrl:"vue component details",componentDetails:{warning:a,ref:n,tag:null,props:null}};e.topic&&(r.topic=e.topic),t.send(r,t.ioChannels.control)}else t.showAlert(e);else t.showToast(e)}})),t.uiReturn={set:function(e,i){var n=["autoSendReady","ctrlMsg","debug","events","httpNodeRoot","ioChannels","ioConnected","ioNamespace","ioPath","ioTransport","isAuthorised","isUnminified","loaded","msg","msgsCtrl","msgsReceived","msgsSent","msgsSentCtrl","moduleName","retryFactor","retryMs","sentMsg","sentCtrlMsg","serverTimeOffset","socket","timerid","url","version","checkConnect","checkTimestamp","emit","get","ioSetup","logon","logoff","markLoggedOut","me","newScript","newStyle","onChange","self","set","send","sendAuth","sendCtrl","setIOnamespace","showComponentDetails","showToast","socket","uiDebug","updateAuth","uiReturn"];if(-1!==n.indexOf(e))return console.warn('[uibuilder:set] Cannot use set() on protected property "'+e+'"'),void t.uiDebug("warn",'uibuilderfe:uibuilder:set: "'+e+'" is in list of excluded properties, not set');if("_auth"===e){if(!i.id||0===i.id.length)return void console.warn("[uibuilder:set] _auth must contain a valid _auth.id property");i.info||(i.info=t.dummyAuth.info)}t.set(e,i)},get:function(e){var i=["checkConnect","checkTimestamp","emit","get","ioSetup","logon","logoff","markLoggedOut","me","newScript","newStyle","onChange","self","set","send","sendAuth","sendCtrl","setIOnamespace","showComponentDetails","showToast","socket","uiDebug","updateAuth","uiReturn"];return-1!==i.indexOf(e)?(console.warn('[uibuilder] Cannot use get() on protected property "'+e+'"'),void t.uiDebug("warn",'uibuilderfe:uibuilder:get: "'+e+'" is in list of excluded properties, not get')):(void 0===t[e]&&console.warn('[uibuilder] get() - property "'+e+'" does not exist'),t[e])},onChange:t.onChange,clearEventListeners:t.clearEventListeners,msg:t.msg,send:t.send,sendCtrl:function(e){t.send(e,t.ioChannels.control)},autoSendReady:function(e){!0!==e&&(e=!1),t.autoSendReady=e},debug:function(e){if("undefined"===typeof e)return t.debug;"boolean"===typeof e&&(t.debug=e)},uiDebug:t.uiDebug,me:t.me,start:function(e,i,n){!0!==t.started?(t.uiDebug("log","[uibuilderfe:start] start() called"),"[object Object]"===toString.call(e)?(t.uiDebug("log","✅ [uibuilderfe:start] namespace IS an object!"),!0===e._isVue?(t.uiDebug("log","✅ [uibuilderfe:start] Vue instance object IS available!"),n=e,e=void 0):(e.ioPath&&(i=e.ioPath),e.vueApp&&(n=e.vueApp),e=e.namespace?e.namespace:void 0)):n?"[object Object]"===toString.call(n)&&!0===n._isVue?t.uiDebug("log","✅ [uibuilderfe:start] Vue instance object IS available!"):(t.uiDebug("log","❌ [uibuilderfe:start] Vue instance object not available!"),n=void 0):t.uiDebug("log","❌ [uibuilderfe:start] app1 not available!"),t.uiDebug("log","[uibuilderfe:start] Calling params - namespace",e,"ioPath",i,"vueApp",n),void 0!==e&&null!==e&&(t.ioNamespace=e),void 0!==i&&null!==i&&(t.ioPath=i),void 0!==n&&null!==n&&(t.vueApp=n),t.uiDebug("log","[uibuilderfe:start] Final Socket.IO params - namespace",e,"ioPath",i),t.ioSetup(),t.started=!0):t.uiDebug("log","❌ [uibuilderfe:start] Start function already called. Do not call more than once.")},logon:t.logon,logoff:t.logoff,showComponentDetails:t.showComponentDetails,showToast:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"globalNotification",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o={_uib:{componentRef:i,options:n},payload:e};t.showToast(o)},eventSend:function(e){if(e.constructor.name.endsWith("Event")&&e.currentTarget){var i=e.currentTarget,n="";try{""!==i.textContent&&(n=i.textContent.substring(0,25))}catch(o){}try{""!==i.name&&(n=i.name)}catch(o){}try{""!==i.id&&(n=i.id)}catch(o){}t.send({topic:t.msg.topic,uibDomEvent:{sourceId:n,event:e.type},payload:i.dataset})}else t.uiDebug("log","[uibuilderfe:eventSend] ARGUMENT NOT A DOM EVENT - use data attributes not function arguments to pass data")},automap:t.automap},window.addEventListener("load",(function(){t.uiDebug("debug","uibuilderfe:load: All resources loaded"),t.loaded=!0})),t.uiReturn}.call(i);function s(t,e){null!==e&&void 0!==e||(e="payload"),"string"!==typeof e&&(console.warn("[uibuilderfe:makeMeAnObject] WARNING: property parameter must be a string and not: "+n(e)),e="payload");var i={};return"object"===n(t)?i=t:null!==t&&(i[e]=t),i}function c(){var t=Array.prototype.slice.call(arguments),e="/"+t.map((function(t){return t.replace(/^\/|\/$/g,"")})).filter((function(t){return t})).join("/");return e.replace("//","/")}r.noConflict=function(){return i.uibuilder=a,r},t.exports&&(e=t.exports=r),e.uibuilder=r}).call(this)},fe07:function(t,e,i){"use strict";i("b329")}});
//# sourceMappingURL=app.2ff94e6a.js.map